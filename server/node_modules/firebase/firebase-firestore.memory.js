!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Bl){"use strict";try{(function(){Bl=Bl&&Object.prototype.hasOwnProperty.call(Bl,"default")?Bl.default:Bl;var t,p,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function r(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=r,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,m=(n(f,l=Error),f);function f(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(E,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var I,T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},N=T||self;function P(){}function S(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),D=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:U).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now||function(){return+new Date};function M(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++D);var t},q.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var K=N.navigator;if(K){var Y=K.userAgent;if(Y){H=Y;break t}}H=""}function $(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function et(t){return et[" "](t),t}et[" "]=P;var nt,it,rt=X(H,"Opera"),ot=X(H,"Trident")||X(H,"MSIE"),st=X(H,"Edge"),ut=st||ot,at=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),ht=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function ct(){var t=N.document;return t?t.documentMode:void 0}t:{var lt="",ft=(it=H,at?/rv:([^\);]+)(\)|;)/.exec(it):st?/Edge\/([\d\.]+)/.exec(it):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ht?/WebKit\/(\S+)/.exec(it):rt?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt,yt={};function vt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(N.document&&ot){var gt=ct();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!vt("9"),Et=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",P,e),N.removeEventListener("test",P,e)}catch(t){}return t}();function _t(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(_t.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}_t.prototype.b=function(){this.defaultPrevented=!0},M(It,_t);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function Pt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++Nt,this.V=this.X=!1}function St(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Ot(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=F(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(St(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Lt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new Pt(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),kt={};function Ut(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Gt(i);return e&&e[At]?e.sa(n,i,R(r)?!!r.capture:!!r,o):Vt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ut(t,e[o],n,i,r);return null}return n=Gt(n),t&&t[At]?t.ra(e,n,R(i)?!!i.capture:!!i,r):Vt(t,e,n,!1,i,r)}function Vt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=R(r)?!!r.capture:!!r;if(s&&!wt)return null;var u,a,h=Ft(t);if(h||(t[Dt]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=qt,i=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Et||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(xt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ct(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[At])Rt(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(xt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ft(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):St(t)}}}function xt(t){return t in kt?kt[t]:kt[t]="on"+t}function Mt(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&Ct(t),n.call(i,e)}function qt(t,e){if(t.V)return!0;if(wt)return Mt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=N,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}function Ft(t){return(t=t[Dt])instanceof Ot?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==S(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Bt(){q.call(this),this.c=new Ot(this),(this.J=this).A=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Rt(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&!i.defaultPrevented}M(Bt,q),Bt.prototype[At]=!0,(I=Bt.prototype).addEventListener=function(t,e,n,i){Ut(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=R(r)?!!r.capture:!!r,i=Gt(i),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Lt(s=e.a[n],i,r,o))&&(St(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ct(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t)t=new _t(t,n);else if(t instanceof _t)t.target=t.target||n;else{var r=t;tt(t=new _t(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=zt(s,i,!0,t)&&r}if(r=zt(s=t.a=n,i,!0,t)&&r,r=zt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=zt(s=t.a=e[o],i,!1,t)&&r;return r},I.C=function(){if(Bt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)St(n[i]);delete e.a[t],e.b--}}this.A=null},I.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Ht=N.JSON.stringify;function Wt(){this.b=this.a=null}var Xt,Qt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Yt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function $t(t){N.setTimeout(function(){throw t},0)}function Jt(t,e){var n;Xt||(n=N.Promise.resolve(void 0),Xt=function(){n.then(ee)}),Zt||(Xt(),Zt=!0),te.add(t,e)}Wt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Wt;function ee(){for(var t;i=n=void 0,i=null,(n=te).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){$t(t)}var e=Qt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,i;Zt=!1}function ne(t,e){Bt.call(this),this.b=t||1,this.a=e||N,this.f=V(this.Ua,this),this.g=x()}function ie(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function re(t,e,n){if("function"==S(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}function oe(t,e,n){q.call(this),this.f=null!=n?V(t,n):t,this.c=e,this.b=V(this.Pa,this),this.a=[]}function se(t){t.T=re(t.b,t.c),t.f.apply(null,t.a)}function ue(t){q.call(this),this.b=t,this.a={}}M(ne,Bt),(I=ne.prototype).Z=!1,I.L=null,I.Ua=function(){if(this.Z){var t=x()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ie(this),this.start()))}},I.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=x())},I.C=function(){ne.M.C.call(this),ie(this),delete this.a},M(oe,q),(I=oe.prototype).ba=!1,I.T=null,I.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},I.C=function(){oe.M.C.call(this),this.T&&(N.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},I.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},M(ue,q);var ae=[];function he(t,e,n,i){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var r=0;r<n.length;r++){var o=Ut(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function le(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=null;function pe(){return fe=fe||new Bt}function de(t){_t.call(this,"serverreachability",t)}function ye(t){var e=pe();e.dispatchEvent(new de(e))}function ve(t){_t.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ve(e))}function me(t){_t.call(this,"timingevent",t)}function we(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}M(de,_t),M(ve,_t),M(me,_t);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function _e(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}_e.prototype.a=null;var Ae,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Pe(){_t.call(this,"d")}function Se(){_t.call(this,"c")}function Oe(){}function Re(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Le,t=ut?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}M(Pe,_t),M(Se,_t),M(Oe,_e),Ae=new Oe;var Le=45e3,De={},ke={};function Ue(t,e,n){t.B=1,t.f=nn(Ye(e)),t.j=n,t.F=!0,Ve(t,null)}function Ve(t,e){t.s=x(),Me(t),t.A=Ye(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),vn(n.b,"t",i),t.w=0,t.a=ui(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(V(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye(1)}function Ce(t,e,n){for(var i=!0;!t.l&&t.w<n.length;){var r=xe(t,n);if(r==ke){4==e&&(t.c=4,ge(14),i=!1);break}if(r==De){t.c=4,ge(15),i=!1;break}Be(t,r)}4==e&&0==n.length&&(t.c=1,ge(16),i=!1),t.b=t.b&&i,i||(Ge(t),je(t))}function xe(t,e){var n=t.w,i=e.indexOf("\n",n);return-1==i?ke:(n=Number(e.substring(n,i)),isNaN(n)?De:(i+=1)+n>e.length?ke:(e=e.substr(i,n),t.w=i+n,e))}function Me(t){t.P=x()+t.N,qe(t,t.N)}function qe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(V(t.Qa,t),e)}function Fe(t){t.h&&(N.clearTimeout(t.h),t.h=null)}function je(t){0==t.g.u||t.l||ni(t.g,t)}function Ge(t){Fe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ie(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||In(n.b,t)))if(n.A=t.H,!t.o&&In(n.b,t)&&3==n.u){try{var i=n.ja.a.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;ei(n),n.a.cancel(),n.a=null}ti(n),ge(18)}}else n.ia=r[1],0<n.ia-n.G&&r[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=we(V(n.Na,n),6e3));if(_n(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else ri(n,11)}else if(!t.o&&n.a!=t||ei(n),!z(e))for(e=i=n.ja.a.parse(e),i=0;i<e.length;i++)if(r=e[i],n.G=r[0],r=r[1],2==n.u)if("c"==r[0]){n.B=r[1],n.R=r[2];var o=r[3];null!=o&&(n.oa=o);var s=r[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Tn(c,c.b),c.b=null))}if(u.s){var l=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(u.ha=l,en(u.v,u.s,l))}}n.u=3,n.c&&n.c.na();var f=t;if((u=n).ea=si(u,u.w?u.R:null,u.P),f.o){An(u.b,f);var p=f,d=u.D;d&&p.setTimeout(d),p.h&&(Fe(p),Me(p)),u.a=f}else Zn(u);0<n.f.length&&Kn(n)}else"stop"!=r[0]&&"close"!=r[0]||ri(n,7);else 3==n.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?ri(n,7):Wn(n):"noop"!=r[0]&&n.c&&n.c.ma(r),n.m=0);ye(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)j(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof He)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Xe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Xe(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Re.prototype).setTimeout=function(t){this.N=t},I.Sa=function(t){t=t.target;var e=this.D;e&&3==Gn(t)?e.Ia():this.ya(t)},I.ya=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.qa(),i=this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||ye(8==n||i<=0?3:2),Fe(this);var r=this.a.S();this.H=r;var o=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,ge(12),Ge(this),je(this);break t}this.o=!0,Be(this,a)}this.F?(Ce(this,e,o),ut&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,o),4==e&&Ge(this),this.b&&!this.l&&(4==e?ni(this.g,this):(this.b=!1,Me(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Ge(this),je(this)}}}catch(t){}},I.Ra=function(){if(this.a){var t=Gn(this.a),e=this.a.Y();this.w<e.length&&(Fe(this),Ce(this,t,e),this.b&&4!=t&&Me(this))}},I.cancel=function(){this.l=!0,Ge(this)},I.Qa=function(){this.h=null;var t=x();0<=t-this.P?(2!=this.B&&(ye(3),ge(17)),Ge(this),this.c=2,je(this)):qe(this,this.P-t)},(I=He.prototype).I=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return We(this),this.a.concat()},I.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},I.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke){this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b;var n=new fn;n.c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),tn(this,n),this.i=t.i}else t&&(n=String(t).match(Qe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Ke(t)}function $e(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var i,r;e instanceof fn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(pn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},i)),i.f=r):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new He,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),Xe(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),B(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ca&&N.ca.ua&&N.ca.ua()&&N.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(I=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){pn(this),this.a.forEach(function(t,e){j(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){pn(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.I=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},I.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.I(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return B(t.c);var i=t.c;try{for(var r=_(t.a.values()),o=r.next();!o.done;o=r.next()){var s=o.value;i=i.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Pn(){}function Sn(){this.a=new Pn}function On(t,i,e){var r=e||"";try{ze(t,function(t,e){var n=t;R(t)&&(n=Ht(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Rn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var Ln=N.JSON.parse;function Dn(t){Bt.call(this),this.headers=new He,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=kn,this.B=this.F=!1}M(Dn,Bt);var kn="",Un=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),Fn(t)}function Mn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Gn(t)||2!=t.S()))if(t.l&&4==Gn(t))re(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.D).match(Qe)[1]||null;if(!o&&N.self&&N.self.location){var s=N.self.location.protocol;o=s.substr(0,s.length-1)}r=!Un.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Mn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){jn(t);var n=t.a,i=t.s[0]?P:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function jn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",$(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=zn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=zn("baseRetryDelayMs",5e3,t),this.Ga=zn("retryDelaySeedMs",1e4,t),this.Da=zn("forwardChannelMaxRetries",2,t),this.ga=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new wn(t&&t.concurrentRequestLimit),this.ja=new Sn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Wn(t){if(Xn(t),3==t.u){var e=t.H++,n=Ye(t.v);en(n,"SID",t.B),en(n,"RID",e),en(n,"TYPE","terminate"),$n(t,n),(e=new Re(t,e,void 0)).B=2,e.f=nn(Ye(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.f.toString(),"")),!n&&N.Image&&((new Image).src=e.f,n=!0),n||(e.a=ui(e.g,null),e.a.$(e.f)),e.s=x(),Me(e)}oi(t)}function Xn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(N.clearTimeout(t.i),t.i=null),ei(t),t.b.cancel(),t.g&&("number"==typeof t.g&&N.clearTimeout(t.g),t.g=null)}function Qn(t,e){t.f.push(new mn(t.Fa++,e)),3==t.u&&Kn(t)}function Kn(t){En(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Yn(t,e){var n;n=e?e.W:t.H++;var i=Ye(t.v);en(i,"SID",t.B),en(i,"RID",n),en(i,"AID",t.G),$n(t,i),t.h&&t.j&&Bn(i,t.h,t.j),n=new Re(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Tn(t.b,n),Ue(n,i,e)}function $n(t,n){t.c&&ze({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.f.length,n);var i=t.c?V(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{On(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function Zn(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function ti(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(V(t.wa,t),ii(t,t.m)),t.m++,1)}function ei(t){null!=t.l&&(N.clearTimeout(t.l),t.l=null)}function ni(t,e){var n=null;if(t.a==e){ei(t),t.a=null;var i=2}else{if(!In(t.b,e))return;n=e.i,An(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==i){n=e.j?e.j.length:0,e=x()-e.s;var r=t.o;(i=pe()).dispatchEvent(new me(i)),Kn(t)}else Zn(t);else if(3==(r=e.c)||0==r&&0<t.A||!(1==i&&function(t,e){if(!(_n(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(V(t.xa,t,e),ii(t,t.o)),t.o++,1}}(t,e)||2==i&&ti(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),r){case 1:ri(t,5);break;case 4:ri(t,10);break;case 3:ri(t,6);break;default:ri(t,2)}}function ii(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ri(t,e){if(2==e){var n=null;t.c&&(n=null);var i=V(t.Ta,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||$e(n,"https"),nn(n)),function(t,e){var n=new le;if(N.Image){var i=new Image;i.onload=C(Rn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=C(Rn,n,i,"TestLoadImage: error",!1,e),i.onabort=C(Rn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=C(Rn,n,i,"TestLoadImage: timeout",!1,e),N.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else ge(2);t.u=0,t.c&&t.c.la(e),oi(t),Xn(t)}function oi(t){t.u=0,t.A=-1,t.c&&(0==Nn(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.ka())}function si(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof Ke?Ye(i):new Ke(i,void 0);if(""!=h.c)e&&Je(h,e+"."+h.c),Ze(h,h.h);else{var c=N.location;r=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new Ke(null,void 0),r&&$e(a,r),o&&Je(a,o),s&&Ze(a,s),u&&(a.g=u),h=a}return t.N&&$(t.N,function(t,e){en(h,e,t)}),e=t.s,n=t.ha,e&&n&&en(h,e,n),en(h,"VER",t.oa),$n(t,h),h}function ui(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ea)).F=t.w,e}function ai(){}function hi(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function ci(t,e){Bt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pi(this)}function li(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fi(){Se.call(this),this.status=1}function pi(t){this.a=t}(I=Dn.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Ae),this.a.onreadystatechange=V(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void xn(this,t)}t=n||"";var r,o=new He(this.headers);i&&ze(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Cn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=N.FormData&&t instanceof N.FormData,0<=F(Vn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.B=(r=this.a,ot&&vt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.ta,this)):this.m=re(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},I.ta=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},I.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Dn.M.C.call(this)},I.va=function(){this.j||(this.w||this.l||this.g?qn(this):this.Oa())},I.Oa=function(){qn(this)},I.S=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},I.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},I.qa=function(){return this.h},I.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(I=Hn.prototype).oa=8,I.u=1,I.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Re(this,t,void 0),i=this.j;if(this.F&&(i?tt(i=J(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(r=Ye(this.v),"RID",t),en(r,"CVER",22),this.s&&en(r,"X-HTTP-Session-Id",this.s),$n(this,r),this.h&&i&&Bn(r,this.h,i),Tn(this.b,n),this.fa?(en(r,"$req",e),en(r,"SID","null"),n.R=!0,Ue(n,r,null)):Ue(n,r,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||En(this.b)||Yn(this))},I.wa=function(){this.i=null,this.a=new Re(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ye(this.ea);en(t,"RID","rpc"),en(t,"SID",this.B),en(t,"CI",this.U?"0":"1"),en(t,"AID",this.G),$n(this,t),en(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=nn(Ye(t)),e.j=null,e.F=!0,Ve(e,n)},I.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,ti(this),ge(19))},I.Ta=function(t){ge(t?2:1)},(I=ai.prototype).na=function(){},I.ma=function(){},I.la=function(){},I.ka=function(){},I.Ha=function(){},hi.prototype.a=function(t,e){return new ci(t,e)},M(ci,Bt),(I=ci.prototype).addEventListener=function(t,e,n,i){ci.M.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){ci.M.removeEventListener.call(this,t,e,n,i)},I.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=si(t,null,t.P),Kn(t)},I.close=function(){Wn(this.a)},I.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Qn(this.a,e)}else this.g?((e={}).__data__=Ht(t),Qn(this.a,e)):Qn(this.a,t)},I.C=function(){this.a.c=null,delete this.f,Wn(this.a),delete this.a,ci.M.C.call(this)},M(li,Pe),M(fi,Se),M(pi,ai),pi.prototype.na=function(){this.a.dispatchEvent("a")},pi.prototype.ma=function(t){this.a.dispatchEvent(new li(t))},pi.prototype.la=function(t){this.a.dispatchEvent(new fi)},pi.prototype.ka=function(){this.a.dispatchEvent("b")},hi.prototype.createWebChannel=hi.prototype.a,ci.prototype.send=ci.prototype.La,ci.prototype.open=ci.prototype.Ka,ci.prototype.close=ci.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Te.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Bt.prototype.listen=Bt.prototype.ra,Dn.prototype.listenOnce=Dn.prototype.sa,Dn.prototype.getLastError=Dn.prototype.Ma,Dn.prototype.getLastErrorCode=Dn.prototype.qa,Dn.prototype.getStatus=Dn.prototype.S,Dn.prototype.getResponseJson=Dn.prototype.Ja,Dn.prototype.getResponseText=Dn.prototype.Y,Dn.prototype.send=Dn.prototype.$;var di={createWebChannelTransport:function(){return new hi},ErrorCode:be,EventType:Ee,WebChannel:Te,XhrIo:Dn},yi=di.createWebChannelTransport,vi=di.ErrorCode,gi=di.EventType,mi=di.WebChannel,wi=di.XhrIo,bi=(Ei.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ei.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ei.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ei);function Ei(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _i=Bl.SDK_VERSION,Ii=new h("@firebase/firestore");function Ti(){return Ii.logLevel}function Ai(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=p.DEBUG){var i=e.map(Pi);Ii.debug.apply(Ii,v(["Firestore ("+_i+"): "+t],i))}}function Ni(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=p.ERROR){var i=e.map(Pi);Ii.error.apply(Ii,v(["Firestore ("+_i+"): "+t],i))}}function Pi(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Si(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+_i+") INTERNAL ASSERTION FAILED: "+t;throw Ni(e),new Error(e)}function Oi(t){t||Si()}function Ri(t){return t}function Li(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}var Di=(ki.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Li(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},ki);function ki(){}function Ui(t,e){return t<e?-1:e<t?1:0}function Vi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Ci(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var xi=(Object.defineProperty(Mi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Mi.prototype.isEqual=function(t){return t instanceof Mi&&t.projectId===this.projectId&&t.database===this.database},Mi.prototype.o=function(t){return Ui(this.projectId,t.projectId)||Ui(this.database,t.database)},Mi);function Mi(t,e){this.projectId=t,this.database=e||"(default)"}function qi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ji(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Gi,Bi,zi=(nr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},nr.prototype.has=function(t){return void 0!==this.get(t)},nr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},nr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},nr.prototype.forEach=function(u){Fi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},nr.prototype._=function(){return ji(this.l)},nr),Hi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Wi=(n(er,Bi=Error),er),Xi=(tr.now=function(){return tr.fromMillis(Date.now())},tr.fromDate=function(t){return tr.fromMillis(t.getTime())},tr.fromMillis=function(t){var e=Math.floor(t/1e3);return new tr(e,1e6*(t-1e3*e))},tr.prototype.toDate=function(){return new Date(this.toMillis())},tr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},tr.prototype.T=function(t){return this.seconds===t.seconds?Ui(this.nanoseconds,t.nanoseconds):Ui(this.seconds,t.seconds)},tr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},tr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},tr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},tr),Qi=(Zi.m=function(t){return new Zi(t)},Zi.min=function(){return new Zi(new Xi(0,0))},Zi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},Zi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Zi.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Zi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Zi.prototype.R=function(){return this.timestamp},Zi),Ki=(Object.defineProperty(Ji.prototype,"length",{get:function(){return this.A},enumerable:!0,configurable:!0}),Ji.prototype.isEqual=function(t){return 0===Ji.P(this,t)},Ji.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Ji?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},Ji.prototype.limit=function(){return this.offset+this.length},Ji.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},Ji.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},Ji.prototype.v=function(){return this.segments[this.offset]},Ji.prototype.S=function(){return this.get(this.length-1)},Ji.prototype.get=function(t){return this.segments[this.offset+t]},Ji.prototype._=function(){return 0===this.length},Ji.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ji.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Ji.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Ji.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},Ji.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Ji),Yi=(n($i,Gi=Ki),$i.prototype.V=function(t,e,n){return new $i(t,e,n)},$i.prototype.$=function(){return this.F().join("/")},$i.prototype.toString=function(){return this.$()},$i.N=function(t){if(0<=t.indexOf("//"))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new $i(t.split("/").filter(function(t){return 0<t.length}))},$i);function $i(){return null!==Gi&&Gi.apply(this,arguments)||this}function Ji(t,e,n){void 0===e?e=0:e>t.length&&Si(),void 0===n?n=t.length-e:n>t.length-e&&Si(),this.segments=t,this.offset=e,this.A=n}function Zi(t){this.timestamp=t}function tr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Wi(Hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Wi(Hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Wi(Hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Wi(Hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function er(t,e){var n=this;return(n=Bi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function nr(t,e){this.h=t,this.u=e,this.l={}}Yi.k=new Yi([]);var ir,rr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,or=(n(sr,ir=Ki),sr.prototype.V=function(t,e,n){return new sr(t,e,n)},sr.L=function(t){return rr.test(t)},sr.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.L(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.$()},sr.prototype.q=function(){return 1===this.length&&"__name__"===this.get(0)},sr.O=function(){return new sr(["__name__"])},sr.M=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Wi(Hi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Wi(Hi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Wi(Hi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr);function sr(){return null!==ir&&ir.apply(this,arguments)||this}or.k=new or([]);var ur=(ar.B=function(t){return new ar(Yi.N(t).p(5))},ar.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ar.prototype.isEqual=function(t){return null!==t&&0===Yi.P(this.path,t.path)},ar.prototype.toString=function(){return this.path.toString()},ar.P=function(t,e){return Yi.P(t.path,e.path)},ar.W=function(t){return t.length%2==0},ar.j=function(t){return new ar(new Yi(t.slice()))},ar);function ar(t){this.path=t}function hr(t){return null==t}function cr(t){return-0===t&&1/t==-1/0}ur.EMPTY=new ur(new Yi([]));var lr=(fr.fromBase64String=function(t){return new fr(atob(t))},fr.fromUint8Array=function(t){return new fr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},fr.prototype.toBase64=function(){return t=this.G,btoa(t);var t},fr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},fr.prototype.K=function(){return 2*this.G.length},fr.prototype.o=function(t){return Ui(this.G,t.G)},fr.prototype.isEqual=function(t){return this.G===t.G},fr);function fr(t){this.G=t}lr.H=new lr("");function pr(t){this.count=t}var dr,yr,vr=(gr.prototype.J=function(t){return new gr(this.target,this.targetId,this.Y,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},gr.prototype.Z=function(t,e){return new gr(this.target,this.targetId,this.Y,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},gr.prototype.tt=function(t){return new gr(this.target,this.targetId,this.Y,this.sequenceNumber,this.X,t,this.resumeToken)},gr);function gr(t,e,n,i,r,o,s){void 0===r&&(r=Qi.min()),void 0===o&&(o=Qi.min()),void 0===s&&(s=lr.H),this.target=t,this.targetId=e,this.Y=n,this.sequenceNumber=i,this.X=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function mr(t){switch(t){case Hi.OK:return Si();case Hi.CANCELLED:case Hi.UNKNOWN:case Hi.DEADLINE_EXCEEDED:case Hi.RESOURCE_EXHAUSTED:case Hi.INTERNAL:case Hi.UNAVAILABLE:case Hi.UNAUTHENTICATED:return;case Hi.INVALID_ARGUMENT:case Hi.NOT_FOUND:case Hi.ALREADY_EXISTS:case Hi.PERMISSION_DENIED:case Hi.FAILED_PRECONDITION:case Hi.ABORTED:case Hi.OUT_OF_RANGE:case Hi.UNIMPLEMENTED:case Hi.DATA_LOSS:return 1;default:return Si()}}function wr(t){if(void 0===t)return Ni("GRPC error has no .code"),Hi.UNKNOWN;switch(t){case dr.OK:return Hi.OK;case dr.CANCELLED:return Hi.CANCELLED;case dr.UNKNOWN:return Hi.UNKNOWN;case dr.DEADLINE_EXCEEDED:return Hi.DEADLINE_EXCEEDED;case dr.RESOURCE_EXHAUSTED:return Hi.RESOURCE_EXHAUSTED;case dr.INTERNAL:return Hi.INTERNAL;case dr.UNAVAILABLE:return Hi.UNAVAILABLE;case dr.UNAUTHENTICATED:return Hi.UNAUTHENTICATED;case dr.INVALID_ARGUMENT:return Hi.INVALID_ARGUMENT;case dr.NOT_FOUND:return Hi.NOT_FOUND;case dr.ALREADY_EXISTS:return Hi.ALREADY_EXISTS;case dr.PERMISSION_DENIED:return Hi.PERMISSION_DENIED;case dr.FAILED_PRECONDITION:return Hi.FAILED_PRECONDITION;case dr.ABORTED:return Hi.ABORTED;case dr.OUT_OF_RANGE:return Hi.OUT_OF_RANGE;case dr.UNIMPLEMENTED:return Hi.UNIMPLEMENTED;case dr.DATA_LOSS:return Hi.DATA_LOSS;default:return Si()}}(yr=dr=dr||{})[yr.OK=0]="OK",yr[yr.CANCELLED=1]="CANCELLED",yr[yr.UNKNOWN=2]="UNKNOWN",yr[yr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yr[yr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yr[yr.NOT_FOUND=5]="NOT_FOUND",yr[yr.ALREADY_EXISTS=6]="ALREADY_EXISTS",yr[yr.PERMISSION_DENIED=7]="PERMISSION_DENIED",yr[yr.UNAUTHENTICATED=16]="UNAUTHENTICATED",yr[yr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yr[yr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yr[yr.ABORTED=10]="ABORTED",yr[yr.OUT_OF_RANGE=11]="OUT_OF_RANGE",yr[yr.UNIMPLEMENTED=12]="UNIMPLEMENTED",yr[yr.INTERNAL=13]="INTERNAL",yr[yr.UNAVAILABLE=14]="UNAVAILABLE",yr[yr.DATA_LOSS=15]="DATA_LOSS";var br=(Ar.prototype.et=function(t,e){return new Ar(this.P,this.root.et(t,e,this.P).st(null,null,_r.nt,null,null))},Ar.prototype.remove=function(t){return new Ar(this.P,this.root.remove(t,this.P).st(null,null,_r.nt,null,null))},Ar.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ar.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ar.prototype._=function(){return this.root._()},Object.defineProperty(Ar.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),Ar.prototype.it=function(){return this.root.it()},Ar.prototype.rt=function(){return this.root.rt()},Ar.prototype.ot=function(t){return this.root.ot(t)},Ar.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ar.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ar.prototype.ht=function(t){return this.root.ht(t)},Ar.prototype.at=function(){return new Er(this.root,null,this.P,!1)},Ar.prototype.ut=function(t){return new Er(this.root,t,this.P,!1)},Ar.prototype.ct=function(){return new Er(this.root,null,this.P,!0)},Ar.prototype.lt=function(t){return new Er(this.root,t,this.P,!0)},Ar),Er=(Tr.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Tr.prototype.wt=function(){return 0<this.ft.length},Tr.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Tr),_r=(Ir.prototype.st=function(t,e,n,i,r){return new Ir(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Ir.prototype._=function(){return!1},Ir.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ir.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ir.prototype.min=function(){return this.left._()?this:this.left.min()},Ir.prototype.it=function(){return this.min().key},Ir.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ir.prototype.et=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.st(null,null,null,i.left.et(t,e,n),null):0===r?i.st(null,e,null,null,null):i.st(null,null,null,null,i.right.et(t,e,n))).Et()},Ir.prototype.It=function(){if(this.left._())return Ir.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.st(null,null,null,t.left.It(),null)).Et()},Ir.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.At()),i=i.st(null,null,null,i.left.remove(t,e),null);else{if(i.left.Rt()&&(i=i.Pt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===e(t,i.key)){if(i.right._())return Ir.EMPTY;n=i.right.min(),i=i.st(n.key,n.value,null,null,i.right.It())}i=i.st(null,null,null,null,i.right.remove(t,e))}return i.Et()},Ir.prototype.Rt=function(){return this.color},Ir.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Ir.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.st(null,null,null,null,t.right.Pt())).pt()).yt()),t},Ir.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Ir.prototype.pt=function(){var t=this.st(null,null,Ir.RED,null,this.right.left);return this.right.st(null,null,this.color,t,null)},Ir.prototype.Pt=function(){var t=this.st(null,null,Ir.RED,this.left.right,null);return this.left.st(null,null,this.color,null,t)},Ir.prototype.yt=function(){var t=this.left.st(null,null,!this.left.color,null,null),e=this.right.st(null,null,!this.right.color,null,null);return this.st(null,null,!this.color,t,e)},Ir.prototype.gt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ir.prototype.bt=function(){if(this.Rt()&&this.left.Rt())throw Si();if(this.right.Rt())throw Si();var t=this.left.bt();if(t!==this.right.bt())throw Si();return t+(this.Rt()?0:1)},Ir);function Ir(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Ir.RED,this.left=null!=i?i:Ir.EMPTY,this.right=null!=r?r:Ir.EMPTY,this.size=this.left.size+1+this.right.size}function Tr(t,e,n,i){this._t=i,this.ft=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this._t?t.left:t.right;else{if(0===r){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ar(t,e){this.P=t,this.root=e||_r.EMPTY}function Nr(){this.size=0}_r.EMPTY=null,_r.RED=!0,_r.nt=!1,_r.EMPTY=(Object.defineProperty(Nr.prototype,"key",{get:function(){throw Si()},enumerable:!0,configurable:!0}),Object.defineProperty(Nr.prototype,"value",{get:function(){throw Si()},enumerable:!0,configurable:!0}),Object.defineProperty(Nr.prototype,"color",{get:function(){throw Si()},enumerable:!0,configurable:!0}),Object.defineProperty(Nr.prototype,"left",{get:function(){throw Si()},enumerable:!0,configurable:!0}),Object.defineProperty(Nr.prototype,"right",{get:function(){throw Si()},enumerable:!0,configurable:!0}),Nr.prototype.st=function(t,e,n,i,r){return this},Nr.prototype.et=function(t,e,n){return new _r(t,e)},Nr.prototype.remove=function(t,e){return this},Nr.prototype._=function(){return!0},Nr.prototype.ot=function(t){return!1},Nr.prototype.ht=function(t){return!1},Nr.prototype.it=function(){return null},Nr.prototype.rt=function(){return null},Nr.prototype.Rt=function(){return!1},Nr.prototype.gt=function(){return!0},Nr.prototype.bt=function(){return 0},new Nr);var Pr=(Lr.prototype.has=function(t){return null!==this.data.get(t)},Lr.prototype.first=function(){return this.data.it()},Lr.prototype.last=function(){return this.data.rt()},Object.defineProperty(Lr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),Lr.prototype.indexOf=function(t){return this.data.indexOf(t)},Lr.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Lr.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var i=n.dt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},Lr.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Lr.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Lr.prototype.at=function(){return new Sr(this.data.at())},Lr.prototype.ut=function(t){return new Sr(this.data.ut(t))},Lr.prototype.add=function(t){return this.st(this.data.remove(t).et(t,!0))},Lr.prototype.delete=function(t){return this.has(t)?this.st(this.data.remove(t)):this},Lr.prototype._=function(){return this.data._()},Lr.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Lr.prototype.isEqual=function(t){if(!(t instanceof Lr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(0!==this.P(i,r))return!1}return!0},Lr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Lr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Lr.prototype.st=function(t){var e=new Lr(this.P);return e.data=t,e},Lr),Sr=(Rr.prototype.dt=function(){return this.Ft.dt().key},Rr.prototype.wt=function(){return this.Ft.wt()},Rr),Or=new br(ur.P);function Rr(t){this.Ft=t}function Lr(t){this.P=t,this.data=new br(this.P)}function Dr(){return Or}function kr(){return Dr()}var Ur=new br(ur.P);function Vr(){return Ur}var Cr=new br(ur.P),xr=new Pr(ur.P);function Mr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=xr,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var qr=new Pr(Ui);function Fr(){return qr}function jr(t,e,n,i){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=i}function Gr(t,e){this.targetId=t,this.ee=e}function Br(t,e,n,i){void 0===n&&(n=lr.H),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var zr=(io.kt=function(t){return new io(t.P)},io.prototype.has=function(t){return null!=this.$t.get(t)},io.prototype.get=function(t){return this.$t.get(t)},io.prototype.first=function(){return this.Nt.it()},io.prototype.last=function(){return this.Nt.rt()},io.prototype._=function(){return this.Nt._()},io.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(io.prototype,"size",{get:function(){return this.Nt.size},enumerable:!0,configurable:!0}),io.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},io.prototype.add=function(t){var e=this.delete(t.key);return e.st(e.$t.et(t.key,t),e.Nt.et(t,null))},io.prototype.delete=function(t){var e=this.get(t);return e?this.st(this.$t.remove(t),this.Nt.remove(e)):this},io.prototype.isEqual=function(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(!i.isEqual(r))return!1}return!0},io.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},io.prototype.st=function(t,e){var n=new io;return n.P=this.P,n.$t=t,n.Nt=e,n},io),Hr=(no.prototype.track=function(t){var e=t.doc.key,n=this.Lt.get(e);!n||0!==t.type&&3===n.type?this.Lt=this.Lt.et(e,t):3===t.type&&1!==n.type?this.Lt=this.Lt.et(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Lt=this.Lt.et(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Lt=this.Lt.et(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Lt=this.Lt.remove(e):1===t.type&&2===n.type?this.Lt=this.Lt.et(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Lt=this.Lt.et(e,{type:2,doc:t.doc}):Si()},no.prototype.qt=function(){var n=[];return this.Lt.ot(function(t,e){n.push(e)}),n},no),Wr=(eo.Ut=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new eo(t,e,zr.kt(e),r,n,i,!0,!1)},Object.defineProperty(eo.prototype,"hasPendingWrites",{get:function(){return!this.xt._()},enumerable:!0,configurable:!0}),eo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Mt===t.Mt&&this.xt.isEqual(t.xt)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},eo),Xr=(to.Kt=function(t,e){var n=new Map;return n.set(t,Qr.zt(t,e)),new to(Qi.min(),n,Fr(),Dr(),Mr())},to),Qr=(Zr.zt=function(t,e){return new Zr(lr.H,e,Mr(),Mr(),Mr())},Zr),Kr=(Object.defineProperty(Jr.prototype,"Ht",{get:function(){return this.re},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,"he",{get:function(){return 0!==this.se},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,"ae",{get:function(){return this.oe},enumerable:!0,configurable:!0}),Jr.prototype.ue=function(t){0<t.K()&&(this.oe=!0,this.ie=t)},Jr.prototype.ce=function(){var n=Mr(),i=Mr(),r=Mr();return this.ne.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Si()}}),new Qr(this.ie,this.re,n,i,r)},Jr.prototype.le=function(){this.oe=!1,this.ne=oo()},Jr.prototype._e=function(t,e){this.oe=!0,this.ne=this.ne.et(t,e)},Jr.prototype.fe=function(t){this.oe=!0,this.ne=this.ne.remove(t)},Jr.prototype.de=function(){this.se+=1},Jr.prototype.we=function(){--this.se},Jr.prototype.Te=function(){this.oe=!0,this.re=!0},Jr),Yr=($r.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var i=n[e];t.te instanceof Ms?this.Ve(i,t.te):t.te instanceof qs&&this.pe(i,t.key,t.te)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.te)}},$r.prototype.ye=function(n){var i=this;this.ge(n,function(t){var e=i.be(t);switch(n.state){case 0:i.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||i.removeTarget(t);break;case 3:i.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:i.ve(t)&&(i.Se(t),e.ue(n.resumeToken));break;default:Si()}})},$r.prototype.ge=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){i.ve(e)&&n(e)})},$r.prototype.Ce=function(t){var e=t.targetId,n=t.ee.count,i=this.De(e);if(i){var r=i.target;if(vu(r))if(0===n){var o=new ur(r.path);this.pe(e,o,new qs(o,Qi.min()))}else Oi(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Ae=this.Ae.add(e))}},$r.prototype.$e=function(r){var o=this,s=new Map;this.me.forEach(function(t,e){var n=o.De(e);if(n){if(t.Ht&&vu(n.target)){var i=new ur(n.target.path);null!==o.Ie.get(i)||o.Ne(e,i)||o.pe(e,i,new qs(i,r))}t.ae&&(s.set(e,t.ce()),t.le())}});var i=Mr();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.Y||(n=!1)}),n&&(i=i.add(t))});var t=new Xr(r,s,this.Ae,this.Ie,i);return this.Ie=Dr(),this.Re=ro(),this.Ae=new Pr(Ui),t},$r.prototype.Ve=function(t,e){if(this.ve(t)){var n=this.Ne(t,e.key)?2:0;this.be(t)._e(e.key,n),this.Ie=this.Ie.et(e.key,e),this.Re=this.Re.et(e.key,this.ke(e.key).add(t))}},$r.prototype.pe=function(t,e,n){if(this.ve(t)){var i=this.be(t);this.Ne(t,e)?i._e(e,1):i.fe(e),this.Re=this.Re.et(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.et(e,n))}},$r.prototype.removeTarget=function(t){this.me.delete(t)},$r.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.Le(t).size+e.Yt.size-e.Jt.size},$r.prototype.de=function(t){this.be(t).de()},$r.prototype.be=function(t){var e=this.me.get(t);return e||(e=new Kr,this.me.set(t,e)),e},$r.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Pr(Ui),this.Re=this.Re.et(t,e)),e},$r.prototype.ve=function(t){var e=null!==this.De(t);return e||Ai("WatchChangeAggregator","Detected inactive target",t),e},$r.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.qe(t)},$r.prototype.Se=function(e){var n=this;this.me.set(e,new Kr),this.Ee.Le(e).forEach(function(t){n.pe(e,t,null)})},$r.prototype.Ne=function(t,e){return this.Ee.Le(t).has(e)},$r);function $r(t){this.Ee=t,this.me=new Map,this.Ie=Dr(),this.Re=ro(),this.Ae=new Pr(Ui)}function Jr(){this.se=0,this.ne=oo(),this.ie=lr.H,this.re=!1,this.oe=!0}function Zr(t,e,n,i,r){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=i,this.Jt=r}function to(t,e,n,i,r){this.X=t,this.Qt=e,this.Wt=n,this.jt=i,this.Gt=r}function eo(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=i,this.xt=r,this.fromCache=o,this.Mt=s,this.Bt=u}function no(){this.Lt=new br(ur.P)}function io(n){this.P=n?function(t,e){return n(t,e)||ur.P(t.key,e.key)}:function(t,e){return ur.P(t.key,e.key)},this.$t=Vr(),this.Nt=new br(this.P)}function ro(){return new br(ur.P)}function oo(){return new br(ur.P)}function so(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function uo(t){var e=vo(t.mapValue.fields.__local_write_time__.timestampValue);return new Xi(e.seconds,e.nanos)}var ao=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?so(t)?4:10:Si()}function co(r,t){var e,n,i,o=ho(r);if(o!==ho(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return uo(r).isEqual(uo(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=vo(r.timestampValue),n=vo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,mo(r.bytesValue).isEqual(mo(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,go((e=r).geoPointValue.latitude)===go(n.geoPointValue.latitude)&&go(e.geoPointValue.longitude)===go(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return go(t.integerValue)===go(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=go(t.doubleValue),i=go(e.doubleValue);return n===i?cr(n)===cr(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return Vi(r.arrayValue.values||[],t.arrayValue.values||[],co);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(qi(e)!==qi(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!co(e[i],n[i])))return!1;return!0}(t);default:return Si()}}function lo(t,e){return void 0!==(t.values||[]).find(function(t){return co(t,e)})}function fo(t,e){var n,i,r,o,s,u,a,h,c,l,f=ho(t),p=ho(e);if(f!==p)return Ui(f,p);switch(f){case 0:return 0;case 1:return Ui(t.booleanValue,e.booleanValue);case 2:return h=e,c=go(t.integerValue||t.doubleValue),l=go(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return po(t.timestampValue,e.timestampValue);case 4:return po(uo(t),uo(e));case 5:return Ui(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=mo(o),a=mo(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Ui(n[r],i[r]);if(0!==o)return o}return Ui(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Ui(go(n.latitude),go(i.latitude)))?r:Ui(go(n.longitude),go(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=fo(n[r],i[r]);if(o)return o}return Ui(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Ui(i[s],o[s]);if(0!==u)return u;var a=fo(n[i[s]],r[o[s]]);if(0!==a)return a}return Ui(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Si()}}function po(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ui(t,e);var n=vo(t),i=vo(e),r=Ui(n.seconds,i.seconds);return 0!==r?r:Ui(n.nanos,i.nanos)}function yo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=vo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?mo(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ur.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Si();var t,e,n}(t)}function vo(t){if(Oi(!!t),"string"!=typeof t)return{seconds:go(t.seconds),nanos:go(t.nanos)};var e=0,n=ao.exec(t);if(Oi(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function go(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mo(t){return"string"==typeof t?lr.fromBase64String(t):lr.fromUint8Array(t)}function wo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function bo(t){return t&&"integerValue"in t}function Eo(t){return!!t&&"arrayValue"in t}function _o(t){return t&&"nullValue"in t}function Io(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function To(t){return t&&"mapValue"in t}var Ao={asc:"ASCENDING",desc:"DESCENDING"},No={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Oe=e};function So(t){return{integerValue:""+t}}function Oo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cr(e)?"-0":e}}function Ro(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Do(t,e){return t.Oe?(Oi(void 0===e||"string"==typeof e),lr.fromBase64String(e||"")):(Oi(void 0===e||e instanceof Uint8Array),lr.fromUint8Array(e||new Uint8Array))}function ko(t){return Oi(!!t),Qi.m((e=vo(t),new Xi(e.seconds,e.nanos)));var e}function Uo(t,e){return new Yi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function Vo(t,e){return Uo(t.s,e.path)}function Co(t,e){var n,i,r,o=(i=e,Oi(Bo(r=Yi.N(i))),r);return Oi(o.get(1)===t.s.projectId),Oi(!o.get(3)&&!t.s.database||o.get(3)===t.s.database),new ur((Oi(4<(n=o).length&&"documents"===n.get(4)),n.p(5)))}function xo(t,e){return Uo(t.s,e)}function Mo(t){return new Yi(["projects",t.s.projectId,"databases",t.s.database]).$()}function qo(t,e,n){return{name:Vo(t,e),fields:n.proto.mapValue.fields}}function Fo(t,e){var n,i,r,o,s,u,a;if(e instanceof hs)n={update:qo(t,e.key,e.value)};else if(e instanceof fs)n={delete:Vo(t,e.key)};else if(e instanceof cs)n={update:qo(t,e.key,e.data),updateMask:(i=e.xe,r=[],i.fields.forEach(function(t){return r.push(t.$())}),{fieldPaths:r})};else if(e instanceof ls)n={transform:{document:Vo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t){var e=t.transform;if(e instanceof zo)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof Wo)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof Xo)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof Qo)return{fieldPath:t.field.$(),increment:e.Me};throw Si()}(t)})}};else{if(!(e instanceof ps))return Si();n={verify:Vo(t,e.key)}}return e.Ue.Be||(n.currentDocument=(o=t,void 0!==(s=e.Ue).updateTime?{updateTime:(u=o,a=s.updateTime,Ro(u,a.R()))}:void 0!==s.exists?{exists:s.exists}:Si())),n}function jo(t){return{before:t.before,values:t.position}}function Go(t){return{fieldPath:t.$()}}function Bo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var zo=(Ho.prototype.Qe=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ho.prototype.We=function(t,e){return e},Ho.prototype.je=function(t){return null},Ho.prototype.isEqual=function(t){return t instanceof Ho},Ho);function Ho(){}zo.instance=new zo;var Wo=($o.prototype.Qe=function(t,e){return this.apply(t)},$o.prototype.We=function(t,e){return this.apply(t)},$o.prototype.apply=function(t){for(var n=Jo(t),e=function(e){n.some(function(t){return co(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},$o.prototype.je=function(t){return null},$o.prototype.isEqual=function(t){return t instanceof $o&&Vi(this.elements,t.elements,co)},$o),Xo=(Yo.prototype.Qe=function(t,e){return this.apply(t)},Yo.prototype.We=function(t,e){return this.apply(t)},Yo.prototype.apply=function(t){for(var n=Jo(t),e=function(e){n=n.filter(function(t){return!co(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Yo.prototype.je=function(t){return null},Yo.prototype.isEqual=function(t){return t instanceof Yo&&Vi(this.elements,t.elements,co)},Yo),Qo=(Ko.prototype.Qe=function(t,e){var n=this.je(t),i=this.asNumber(n)+this.asNumber(this.Me);return bo(n)&&bo(this.Me)?So(i):Oo(this.serializer,i)},Ko.prototype.We=function(t,e){return e},Ko.prototype.je=function(t){return bo(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Ko.prototype.isEqual=function(t){return t instanceof Ko&&co(this.Me,t.Me)},Ko.prototype.asNumber=function(t){return go(t.integerValue||t.doubleValue)},Ko);function Ko(t,e){this.serializer=t,this.Me=e}function Yo(t){this.elements=t}function $o(t){this.elements=t}function Jo(t){return Eo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Zo(t,e){this.version=t,this.transformResults=e}var ts,es,ns,is,rs,os=(Ns.prototype.Ge=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),ss=(As.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},As),us=(Ts.Ke=function(){return new Ts},Ts.exists=function(t){return new Ts(void 0,t)},Ts.updateTime=function(t){return new Ts(t)},Object.defineProperty(Ts.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Ts.prototype.ze=function(t){return void 0!==this.updateTime?t instanceof Ms&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Ms},Ts.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ts),as=(Is.prototype.He=function(t){},Is.Ye=function(t){return t instanceof Ms?t.version:Qi.min()},Is),hs=(n(_s,rs=as),_s.prototype.We=function(t,e){this.He(t);var n=e.version;return new Ms(this.key,n,this.value,{hasCommittedMutations:!0})},_s.prototype.Qe=function(t,e,n){if(this.He(t),!this.Ue.ze(t))return t;var i=as.Ye(t);return new Ms(this.key,i,this.value,{Xe:!0})},_s.prototype.Je=function(t){return null},_s.prototype.isEqual=function(t){return t instanceof _s&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Ue.isEqual(t.Ue)},_s),cs=(n(Es,is=as),Es.prototype.We=function(t,e){if(this.He(t),!this.Ue.ze(t))return new Fs(this.key,e.version);var n=this.Ze(t);return new Ms(this.key,e.version,n,{hasCommittedMutations:!0})},Es.prototype.Qe=function(t,e,n){if(this.He(t),!this.Ue.ze(t))return t;var i=as.Ye(t),r=this.Ze(t);return new Ms(this.key,i,r,{Xe:!0})},Es.prototype.Je=function(t){return null},Es.prototype.isEqual=function(t){return t instanceof Es&&this.key.isEqual(t.key)&&this.xe.isEqual(t.xe)&&this.Ue.isEqual(t.Ue)},Es.prototype.Ze=function(t){var e;return e=t instanceof Ms?t.data():ds.empty(),this.ts(e)},Es.prototype.ts=function(t){var n=this,i=new ys(t);return this.xe.fields.forEach(function(t){if(!t._()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.es()},Es),ls=(n(bs,ns=as),bs.prototype.We=function(t,e){if(this.He(t),Oi(null!=e.transformResults),!this.Ue.ze(t))return new Fs(this.key,e.version);var n=this.ss(t),i=this.ns(t,e.transformResults),r=e.version,o=this.rs(n.data(),i);return new Ms(this.key,r,o,{hasCommittedMutations:!0})},bs.prototype.Qe=function(t,e,n){if(this.He(t),!this.Ue.ze(t))return t;var i=this.ss(t),r=this.os(n,t,e),o=this.rs(i.data(),r);return new Ms(this.key,i.version,o,{Xe:!0})},bs.prototype.Je=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Ms?t.field(r.field):void 0,s=r.transform.je(o||null);null!=s&&(e=null==e?(new ys).set(r.field,s):e.set(r.field,s))}return e?e.es():null},bs.prototype.isEqual=function(t){return t instanceof bs&&this.key.isEqual(t.key)&&Vi(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Ue.isEqual(t.Ue)},bs.prototype.ss=function(t){return t},bs.prototype.ns=function(t,e){var n=[];Oi(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Ms&&(s=t.field(r.field)),n.push(o.We(s,e[i]))}return n},bs.prototype.os=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Ms&&(a=e.field(s.field)),null===a&&n instanceof Ms&&(a=n.field(s.field)),i.push(u.Qe(a,t))}return i},bs.prototype.rs=function(t,e){for(var n=new ys(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.es()},bs),fs=(n(ws,es=as),ws.prototype.We=function(t,e){return this.He(t),new qs(this.key,e.version,{hasCommittedMutations:!0})},ws.prototype.Qe=function(t,e,n){return this.He(t),this.Ue.ze(t)?new qs(this.key,Qi.min()):t},ws.prototype.Je=function(t){return null},ws.prototype.isEqual=function(t){return t instanceof ws&&this.key.isEqual(t.key)&&this.Ue.isEqual(t.Ue)},ws),ps=(n(ms,ts=as),ms.prototype.We=function(t,e){Si()},ms.prototype.Qe=function(t,e,n){Si()},ms.prototype.Je=function(t){Si()},ms.prototype.isEqual=function(t){return t instanceof ms&&this.key.isEqual(t.key)&&this.Ue.isEqual(t.Ue)},ms),ds=(gs.empty=function(){return new gs({mapValue:{}})},gs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!To(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},gs.prototype.isEqual=function(t){return co(this.proto,t.proto)},gs),ys=(vs.prototype.set=function(t,e){return this.us(t,e),this},vs.prototype.delete=function(t){return this.us(t,null),this},vs.prototype.us=function(t,e){for(var n=this.as,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===ho(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.S(),e)},vs.prototype.es=function(){var t=this.cs(or.k,this.as);return null!=t?new ds(t):this.hs},vs.prototype.cs=function(i,t){var r=this,o=!1,e=this.hs.field(i),s=To(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.cs(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},vs);function vs(t){void 0===t&&(t=ds.empty()),this.hs=t,this.as=new Map}function gs(t){this.proto=t}function ms(t,e){var n=this;return(n=ts.call(this)||this).key=t,n.Ue=e,n.type=4,n}function ws(t,e){var n=this;return(n=es.call(this)||this).key=t,n.Ue=e,n.type=3,n}function bs(t,e){var n=this;return(n=ns.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=us.exists(!0),n}function Es(t,e,n,i){var r=this;return(r=is.call(this)||this).key=t,r.data=e,r.xe=n,r.Ue=i,r.type=1,r}function _s(t,e,n){var i=this;return(i=rs.call(this)||this).key=t,i.value=e,i.Ue=n,i.type=0,i}function Is(){}function Ts(t,e){this.updateTime=t,this.exists=e}function As(t,e){this.field=t,this.transform=e}function Ns(t){(this.fields=t).sort(or.P)}function Ps(t){var u=[];return Fi(t.fields||{},function(t,e){var n=new or([t]);if(To(e)){var i=Ps(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new os(u)}function Ss(t,e){this.key=t,this.version=e}var Os,Rs,Ls,Ds,ks,Us,Vs,Cs,xs,Ms=(n(ru,xs=Ss),ru.prototype.field=function(t){return this.ls.field(t)},ru.prototype.data=function(){return this.ls},ru.prototype._s=function(){return this.ls.proto},ru.prototype.isEqual=function(t){return t instanceof ru&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Xe===t.Xe&&this.hasCommittedMutations===t.hasCommittedMutations&&this.ls.isEqual(t.ls)},ru.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.ls.toString()+", {hasLocalMutations: "+this.Xe+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return this.Xe||this.hasCommittedMutations},enumerable:!0,configurable:!0}),ru),qs=(n(iu,Cs=Ss),iu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),iu.prototype.isEqual=function(t){return t instanceof iu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},iu),Fs=(n(nu,Vs=Ss),nu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),js=(eu.ms=function(t){return new eu(t)},Object.defineProperty(eu.prototype,"orderBy",{get:function(){if(null===this.ws){this.ws=[];var t=this.Is(),e=this.Rs();if(null!==t&&null===e)t.q()||this.ws.push(new hu(t)),this.ws.push(new hu(or.O(),"asc"));else{for(var n=!1,i=0,r=this.fs;i<r.length;i++){var o=r[i];this.ws.push(o),o.field.q()&&(n=!0)}if(!n){var s=0<this.fs.length?this.fs[this.fs.length-1].dir:"asc";this.ws.push(new hu(or.O(),s))}}}return this.ws},enumerable:!0,configurable:!0}),eu.prototype.As=function(t){var e=this.filters.concat([t]);return new eu(this.path,this.collectionGroup,this.fs.slice(),e,this.limit,this.ds,this.startAt,this.endAt)},eu.prototype.Ps=function(t){var e=this.fs.concat([t]);return new eu(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.ds,this.startAt,this.endAt)},eu.prototype.Vs=function(t){return new eu(this.path,this.collectionGroup,this.fs.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},eu.prototype.ps=function(t){return new eu(this.path,this.collectionGroup,this.fs.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},eu.prototype.ys=function(t){return new eu(this.path,this.collectionGroup,this.fs.slice(),this.filters.slice(),this.limit,this.ds,t,this.endAt)},eu.prototype.gs=function(t){return new eu(this.path,this.collectionGroup,this.fs.slice(),this.filters.slice(),this.limit,this.ds,this.startAt,t)},eu.prototype.bs=function(t){return new eu(t,null,this.fs.slice(),this.filters.slice(),this.limit,this.ds,this.startAt,this.endAt)},eu.prototype.vs=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.fs.length||1===this.fs.length&&this.fs[0].field.q())},eu.prototype.canonicalId=function(){return du(this.Ss())+"|lt:"+this.ds},eu.prototype.toString=function(){return"Query(target="+(t=this.Ss(),e=t.path.$(),null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),0<t.filters.length&&(e+=", filters: ["+t.filters.join(", ")+"]"),hr(t.limit)||(e+=", limit: "+t.limit),0<t.orderBy.length&&(e+=", orderBy: ["+t.orderBy.join(", ")+"]"),t.startAt&&(e+=", startAt: "+ou(t.startAt)),t.endAt&&(e+=", endAt: "+ou(t.endAt)),"Target("+e+")")+"; limitType="+this.ds+")";var t,e},eu.prototype.isEqual=function(t){return yu(this.Ss(),t.Ss())&&this.ds===t.ds},eu.prototype.Cs=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.q()}return 0},eu.prototype.matches=function(t){return this.Ds(t)&&this.Fs(t)&&this.$s(t)&&this.Ns(t)},eu.prototype.ks=function(){return!hr(this.limit)&&"F"===this.ds},eu.prototype.Ls=function(){return!hr(this.limit)&&"L"===this.ds},eu.prototype.Rs=function(){return 0<this.fs.length?this.fs[0].field:null},eu.prototype.Is=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Gs&&n.qs())return n.field}return null},eu.prototype.Os=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Gs&&0<=t.indexOf(i.op))return i.op}return null},eu.prototype.xs=function(){return vu(this.Ss())},eu.prototype.Ms=function(){return null!==this.collectionGroup},eu.prototype.Ss=function(){if(!this.Ts)if("F"===this.ds)this.Ts=pu(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new hu(i.field,r))}var o=this.endAt?new Qs(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Qs(this.startAt.position,!this.startAt.before):null;this.Ts=pu(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ts},eu.prototype.Ds=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.U(this.collectionGroup)&&this.path.C(e):ur.W(this.path)?this.path.isEqual(e):this.path.D(e)},eu.prototype.Fs=function(t){for(var e=0,n=this.fs;e<n.length;e++){var i=n[e];if(!i.field.q()&&null===t.field(i.field))return!1}return!0},eu.prototype.$s=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},eu.prototype.Ns=function(t){return!(this.startAt&&!su(this.startAt,this.orderBy,t)||this.endAt&&su(this.endAt,this.orderBy,t))},eu.prototype.Es=function(t){},eu),Gs=(n(tu,Us=function(){}),tu.create=function(t,e,n){if(t.q())return"in"===e?new zs(t,n):new Bs(t,e,n);if(_o(n)){if("=="!==e)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new tu(t,e,n)}if(Io(n)){if("=="!==e)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new tu(t,e,n)}return"array-contains"===e?new Hs(t,n):"in"===e?new Ws(t,n):"array-contains-any"===e?new Xs(t,n):new tu(t,e,n)},tu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ho(this.value)===ho(e)&&this.Bs(fo(e,this.value))},tu.prototype.Bs=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Si()}},tu.prototype.qs=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},tu.prototype.canonicalId=function(){return this.field.$()+this.op.toString()+yo(this.value)},tu.prototype.isEqual=function(t){return t instanceof tu&&this.op===t.op&&this.field.isEqual(t.field)&&co(this.value,t.value)},tu.prototype.toString=function(){return this.field.$()+" "+this.op+" "+yo(this.value)},tu),Bs=(n(Zs,ks=Gs),Zs.prototype.matches=function(t){var e=ur.P(t.key,this.key);return this.Bs(e)},Zs),zs=(n(Js,Ds=Gs),Js.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Js),Hs=(n($s,Ls=Gs),$s.prototype.matches=function(t){var e=t.field(this.field);return Eo(e)&&lo(e.arrayValue,this.value)},$s),Ws=(n(Ys,Rs=Gs),Ys.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&lo(this.value.arrayValue,e)},Ys),Xs=(n(Ks,Os=Gs),Ks.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Eo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return lo(e.value.arrayValue,t)})},Ks),Qs=function(t,e){this.position=t,this.before=e};function Ks(t,e){return Os.call(this,t,"array-contains-any",e)||this}function Ys(t,e){return Rs.call(this,t,"in",e)||this}function $s(t,e){return Ls.call(this,t,"array-contains",e)||this}function Js(t,e){var n=this;return(n=Ds.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ur.B(t.referenceValue)}),n}function Zs(t,e,n){var i=this;return(i=ks.call(this,t,e,n)||this).key=ur.B(n.referenceValue),i}function tu(t,e,n){var i=this;return(i=Us.call(this)||this).field=t,i.op=e,i.value=n,i}function eu(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.fs=n,this.filters=i,this.limit=r,this.ds=o,this.startAt=s,this.endAt=u,this.ws=null,this.Ts=null,this.startAt&&this.Es(this.startAt),this.endAt&&this.Es(this.endAt)}function nu(){return null!==Vs&&Vs.apply(this,arguments)||this}function iu(t,e,n){var i=this;return(i=Cs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function ru(t,e,n,i){var r=this;return(r=xs.call(this,t,e)||this).ls=n,r.Xe=!!i.Xe,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function ou(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return yo(t)}).join(",")}function su(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r];if(i=o.field.q()?ur.P(ur.B(s.referenceValue),n.key):fo(s,n.field(o.field)),"desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function uu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!co(t.position[n],e.position[n]))return!1;return!0}var au,hu=(fu.prototype.compare=function(t,e){var n,i,r,o,s=this.Us?ur.P(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?fo(r,o):Si());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Si()}},fu.prototype.canonicalId=function(){return this.field.$()+this.dir.toString()},fu.prototype.toString=function(){return this.field.$()+" ("+this.dir+")"},fu.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},fu),cu=(n(lu,au=function(t,e,n,i,r,o,s){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s}),lu);function lu(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null);var u=this;return(u=au.call(this,t,e,n,i,r,o,s)||this).Qs=null,u}function fu(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.Us=t.q()}function pu(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new cu(t,e,n,i,r,o,s)}function du(t){var e=Ri(t);if(null===e.Qs){var n=e.path.$();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return t.canonicalId()}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return t.canonicalId()}).join(","),hr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ou(e.startAt)),e.endAt&&(n+="|ub:",n+=ou(e.endAt)),e.Qs=n}return e.Qs}function yu(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!t.orderBy[n].isEqual(e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var i=0;i<t.filters.length;i++)if(!t.filters[i].isEqual(e.filters[i]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uu(t.startAt,e.startAt)&&uu(t.endAt,e.endAt)}function vu(t){return ur.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var gu=(Su.prototype.We=function(t,e,n){for(var i=n.js,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.We(e,s)}}return e},Su.prototype.Qe=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.Qe(e,e,this.Ws))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.Qe(e,o,this.Ws))}return e},Su.prototype.Gs=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.Qe(t.key,n.get(t.key));e&&(r=r.et(t.key,e))}),r},Su.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Mr())},Su.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vi(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Vi(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Su),mu=(Pu.from=function(t,e,n){Oi(t.mutations.length===n.length);for(var i=Cr,r=t.mutations,o=0;o<r.length;o++)i=i.et(r[o].key,n[o].version);return new Pu(t,e,n,i)},Pu),wu=(Nu.prototype.catch=function(t){return this.next(void 0,t)},Nu.prototype.next=function(i,r){var o=this;return this.Js&&Si(),this.Js=!0,this.Xs?this.error?this.Zs(r,this.error):this.tn(i,this.result):new Nu(function(e,n){o.Hs=function(t){o.tn(i,t).next(e,n)},o.Ys=function(t){o.Zs(r,t).next(e,n)}})},Nu.prototype.en=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Nu.prototype.sn=function(t){try{var e=t();return e instanceof Nu?e:Nu.resolve(e)}catch(t){return Nu.reject(t)}},Nu.prototype.tn=function(t,e){return t?this.sn(function(){return t(e)}):Nu.resolve(e)},Nu.prototype.Zs=function(t,e){return t?this.sn(function(){return t(e)}):Nu.reject(e)},Nu.resolve=function(n){return new Nu(function(t,e){t(n)})},Nu.reject=function(n){return new Nu(function(t,e){e(n)})},Nu.nn=function(t){return new Nu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Nu.rn=function(t){for(var n=Nu.resolve(!1),e=function(e){n=n.next(function(t){return t?Nu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Nu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.nn(r)},Nu),bu=(Au.prototype.un=function(e,n){var i=this;return this.hn.cn(e,n).next(function(t){return i.ln(e,n,t)})},Au.prototype.ln=function(t,i,r){return this.on._n(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].Qe(i,t);return t})},Au.prototype.fn=function(t,e,r){var o=kr();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].Qe(t,e);o=o.et(t,e)}),o},Au.prototype.dn=function(e,t){var n=this;return this.on.getEntries(e,t).next(function(t){return n.wn(e,t)})},Au.prototype.wn=function(i,r){var o=this;return this.hn.Tn(i,r).next(function(t){var e=o.fn(i,r,t),n=Dr();return e.forEach(function(t,e){e=e||new qs(t,Qi.min()),n=n.et(t,e)}),n})},Au.prototype.En=function(t,e,n){return e.xs()?this.mn(t,e.path):e.Ms()?this.In(t,e,n):this.Rn(t,e,n)},Au.prototype.mn=function(t,e){return this.un(t,new ur(e)).next(function(t){var e=Vr();return t instanceof Ms&&(e=e.et(t.key,t)),e})},Au.prototype.In=function(n,i,r){var o=this,s=i.collectionGroup,u=Vr();return this.an.An(n,s).next(function(t){return wu.forEach(t,function(t){var e=i.bs(t.child(s));return o.Rn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.et(t,e)})})}).next(function(){return u})})},Au.prototype.Rn=function(e,n,t){var c,l,i=this;return this.on.En(e,n,t).next(function(t){return c=t,i.hn.Pn(e,n)}).next(function(t){return l=t,i.Vn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.Qe(a,a,i.Ws);c=h instanceof Ms?c.et(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Au.prototype.Vn=function(t,e,n){for(var i=Mr(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof cs&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.on.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ms&&(h=h.et(t,e))}),h})},Au),Eu=(Tu.gn=function(t,e){for(var n=Mr(),i=Mr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Tu(t,e.fromCache,n,i)},Tu),_u=(Iu.prototype.vn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Iu.prototype.next=function(){var t=++this.previousValue;return this.Sn&&this.Sn(t),t},Iu);function Iu(t,e){var n=this;this.previousValue=t,e&&(e.bn=function(t){return n.vn(t)},this.Sn=function(t){return e.Cn(t)})}function Tu(t,e,n,i){this.targetId=t,this.fromCache=e,this.pn=n,this.yn=i}function Au(t,e,n){this.on=t,this.hn=e,this.an=n}function Nu(t){var e=this;this.Hs=null,this.Ys=null,this.result=void 0,this.error=void 0,this.Xs=!1,this.Js=!1,t(function(t){e.Xs=!0,e.result=t,e.Hs&&e.Hs(t)},function(t){e.Xs=!0,e.error=t,e.Ys&&e.Ys(t)})}function Pu(t,e,n,i){this.batch=t,this.Ks=e,this.js=n,this.zs=i}function Su(t,e,n,i){this.batchId=t,this.Ws=e,this.baseMutations=n,this.mutations=i}_u.Dn=-1;function Ou(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ru=(xu.prototype.reset=function(){this.qn=0},xu.prototype.Mn=function(){this.qn=this.Ln},xu.prototype.Bn=function(t){var e=this;this.cancel();var n=Math.floor(this.qn+this.Un()),i=Math.max(0,Date.now()-this.xn),r=Math.max(0,n-i);0<r&&Ai("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.qn+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.On=this.Fn.Qn(this.$n,r,function(){return e.xn=Date.now(),t()}),this.qn*=this.kn,this.qn<this.Nn&&(this.qn=this.Nn),this.qn>this.Ln&&(this.qn=this.Ln)},xu.prototype.Wn=function(){null!==this.On&&(this.On.jn(),this.On=null)},xu.prototype.cancel=function(){null!==this.On&&(this.On.cancel(),this.On=null)},xu.prototype.Un=function(){return(Math.random()-.5)*this.qn},xu),Lu=(Cu.prototype.Kn=function(t,e){return this.Gn.add(e),wu.resolve()},Cu.prototype.An=function(t,e){return wu.resolve(this.Gn.getEntries(e))},Cu),Du=(Vu.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Pr(Yi.P),r=!i.has(n);return this.index[e]=i.add(n),r},Vu.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Vu.prototype.getEntries=function(t){return(this.index[t]||new Pr(Yi.P)).F()},Vu),ku=(Uu.prototype.next=function(){return this.zn+=2,this.zn},Uu.Hn=function(){return new Uu(0)},Uu.Yn=function(){return new Uu(-1)},Uu);function Uu(t){this.zn=t}function Vu(){this.index={}}function Cu(){this.Gn=new Du}function xu(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Fn=t,this.$n=e,this.Nn=n,this.kn=i,this.Ln=r,this.qn=0,this.On=null,this.xn=Date.now(),this.reset()}function Mu(t){return"IndexedDbTransactionError"===t.name}function qu(){return"undefined"!=typeof window?window:null}var Fu=(Bu.ei=function(t,e,n,i,r){var o=new Bu(t,e,Date.now()+n,i,r);return o.start(n),o},Bu.prototype.start=function(t){var e=this;this.si=setTimeout(function(){return e.ni()},t)},Bu.prototype.jn=function(){return this.ni()},Bu.prototype.cancel=function(t){null!==this.si&&(this.clearTimeout(),this.ti.reject(new Wi(Hi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Bu.prototype.ni=function(){var e=this;this.Xn.ii(function(){return null!==e.si?(e.clearTimeout(),e.op().then(function(t){return e.ti.resolve(t)})):Promise.resolve()})},Bu.prototype.clearTimeout=function(){null!==this.si&&(this.Zn(this),clearTimeout(this.si),this.si=null)},Bu),ju=(Object.defineProperty(Gu.prototype,"di",{get:function(){return this.hi},enumerable:!0,configurable:!0}),Gu.prototype.ii=function(t){this.enqueue(t)},Gu.prototype.wi=function(t){this.Ti(),this.Ei(t)},Gu.prototype.mi=function(t){return this.Ti(),this.Ei(t)},Gu.prototype.Ii=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Ti(),this.hi?[3,2]:(this.hi=!0,(e=qu())&&e.removeEventListener("visibilitychange",this.fi),[4,this.mi(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Gu.prototype.enqueue=function(t){return this.Ti(),this.hi?new Promise(function(t){}):this.Ei(t)},Gu.prototype.Ri=function(r){var t=this;this.Ti(),this.hi||(this.oi=this.oi.then(function(){var n=new Ou,i=function(){return d(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this._i.reset(),[3,3];case 2:if(!Mu(e=t.sent()))throw n.resolve(),e;return Ai("AsyncQueue","Operation failed with retryable error: "+e),this._i.Bn(i),[3,3];case 3:return[2]}})})};return t.ii(i),n.promise}))},Gu.prototype.Ei=function(t){var i=this,e=this.ri.then(function(){return i.ci=!0,t().catch(function(t){throw i.ui=t,i.ci=!1,Ni("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.ci=!1,t})});return this.ri=e},Gu.prototype.Qn=function(t,e,n){var i=this;this.Ti(),-1<this.li.indexOf(t)&&(e=0);var r=Fu.ei(this,t,e,n,function(t){return i.Ai(t)});return this.ai.push(r),r},Gu.prototype.Ti=function(){this.ui&&Si()},Gu.prototype.Pi=function(){},Gu.prototype.Vi=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.ri];case 1:t.sent(),t.label=2;case 2:if(e!==this.ri)return[3,0];t.label=3;case 3:return[2]}})})},Gu.prototype.pi=function(t){for(var e=0,n=this.ai;e<n.length;e++)if(n[e].$n===t)return!0;return!1},Gu.prototype.yi=function(i){var r=this;return this.Vi().then(function(){r.ai.sort(function(t,e){return t.Jn-e.Jn});for(var t=0,e=r.ai;t<e.length;t++){var n=e[t];if(n.jn(),"all"!==i&&n.$n===i)break}return r.Vi()})},Gu.prototype.gi=function(t){this.li.push(t)},Gu.prototype.Ai=function(t){var e=this.ai.indexOf(t);this.ai.splice(e,1)},Gu);function Gu(){var t=this;this.ri=Promise.resolve(),this.oi=Promise.resolve(),this.hi=!1,this.ai=[],this.ui=null,this.ci=!1,this.li=[],this._i=new Ru(this,"async_queue_retry"),this.fi=function(){return t._i.Wn()};var e=qu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.fi)}function Bu(t,e,n,i,r){this.Xn=t,this.$n=e,this.Jn=n,this.op=i,this.Zn=r,this.ti=new Ou,this.then=this.ti.promise.then.bind(this.ti.promise),this.ti.promise.catch(function(t){})}function zu(t,e){if(Ni("AsyncQueue",e+": "+t),Mu(t))return new Wi(Hi.UNAVAILABLE,e+": "+t);throw t}var Hu=(Wu.Ci=function(t){return new Wu(t,Wu.Di,Wu.Fi)},Wu);function Wu(t,e,n){this.bi=t,this.vi=e,this.Si=n}Hu.$i=-1,Hu.Ni=1048576,Hu.ki=41943040,Hu.Di=10,Hu.Fi=1e3,Hu.Li=new Hu(Hu.ki,Hu.Di,Hu.Fi),Hu.DISABLED=new Hu(Hu.$i,0,0);var Xu=(Qu.prototype.start=function(){return Promise.resolve()},Qu.prototype.Hi=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.hn,m=this.Gi,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.hn.Yi(v).next(function(t){return g=t,e=i.persistence.Bi(r),m=new bu(i.Ui,e,i.persistence.Ki()),e.Yi(v)}).next(function(t){for(var e=[],n=[],i=Mr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.dn(v,i).next(function(t){return{Xi:t,Ji:e,Zi:n}})})})];case 1:return n=t.sent(),[2,(this.hn=e,this.Gi=m,this.qi.zi(this.Gi),n)]}})})},Qu.prototype.tr=function(u){var a,h=this,c=Xi.now(),t=u.reduce(function(t,e){return t.add(e.key)},Mr());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Gi.dn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Je(a.get(r.key));null!=o&&e.push(new cs(r.key,o,Ps(o.proto.mapValue),us.exists(!0)))}return h.hn.er(s,c,e,u)})}).then(function(t){var e=t.Gs(a);return{batchId:t.batchId,sr:e}})},Qu.prototype.nr=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Ui.ir({rr:!0});return r.or(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.hn.hr(t)}).next(function(){return r.Gi.dn(t,e)})})},Qu.prototype.ar=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hn.ur(e,t).next(function(t){return Oi(null!==t),n=t.keys(),i.hn.cr(e,t)}).next(function(){return i.hn.hr(e)}).next(function(){return i.Gi.dn(e,n)})})},Qu.prototype.lr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hn.lr(t)})},Qu.prototype._r=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Wi._r(t)})},Qu.prototype.dr=function(a){var h=this,c=a.X,l=this.Oi;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Ui.ir({rr:!0});l=h.Oi;var s=[];a.Qt.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.Wi.wr(o,t.Jt,e).next(function(){return h.Wi.Tr(o,t.Yt,e)}));var i=t.resumeToken;if(0<i.K()){var r=n.Z(i,c).J(o.Er);l=l.et(e,r),Qu.mr(n,r,t)&&s.push(h.Wi.Ir(o,r))}}});var u=Dr(),n=Mr();if(a.jt.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.jt.forEach(function(t,e){var n=i.get(t);e instanceof qs&&e.version.isEqual(Qi.min())?(r.Rr(t,c),u=u.et(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.Ar(e,c),u=u.et(t,e)):Ai("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Gt.has(t)&&s.push(h.persistence.Vr.Pr(o,t))})})),!c.isEqual(Qi.min())){var t=h.Wi._r(o).next(function(t){return h.Wi.pr(o,o.Er,c)});s.push(t)}return wu.nn(s).next(function(){return r.apply(o)}).next(function(){return h.Gi.wn(o,u)})}).then(function(t){return h.Oi=l,t})},Qu.mr=function(t,e,n){return Oi(0<e.resumeToken.K()),0===t.resumeToken.K()||e.X.I()-t.X.I()>=this.yr||0<n.Yt.size+n.Xt.size+n.Jt.size},Qu.prototype.gr=function(c){return d(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return wu.forEach(c,function(e){return wu.forEach(e.pn,function(t){return h.persistence.Vr.br(n,e.targetId,t)}).next(function(){return wu.forEach(e.yn,function(t){return h.persistence.Vr.vr(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Mu(e=t.sent()))throw e;return Ai("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this.Oi.get(o),u=s.X,a=s.tt(u),this.Oi=this.Oi.et(o,a));return[2]}})})},Qu.prototype.Sr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.hn.Cr(t,e)})},Qu.prototype.Dr=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Gi.un(t,e)})},Qu.prototype.Fr=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Wi.$r(e,i).next(function(t){return t?(n=t,wu.resolve(n)):r.Wi.Nr(e).next(function(t){return n=new vr(i,t,0,e.Er),r.Wi.kr(e,n).next(function(){return n})})})}).then(function(t){var e=r.Oi.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(r.Oi=r.Oi.et(t.targetId,t),r.xi.set(i,t.targetId)),t})},Qu.prototype.$r=function(t,e){var n=this.xi.get(e);return void 0!==n?wu.resolve(this.Oi.get(n)):this.Wi.$r(t,e)},Qu.prototype.Lr=function(t,e){var n=this,i=this.Oi.get(t),r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",r,function(t){return e?wu.resolve():n.persistence.Vr.removeTarget(t,i)}).then(function(){n.Oi=n.Oi.remove(t),n.xi.delete(i.target)})},Qu.prototype.qr=function(t,n){var i=this,r=Qi.min(),o=Mr();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.$r(e,t.Ss()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Wi.Or(e,t.targetId).next(function(t){o=t})}).next(function(){return i.qi.En(e,t,n?r:Qi.min(),n?o:Mr())}).next(function(t){return{documents:t,xr:o}})})},Qu.prototype.or=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=wu.resolve();return n.forEach(function(i){u=u.next(function(){return o._n(t,i)}).next(function(t){var e=t,n=r.zs.get(i);Oi(null!==n),(!e||e.version.o(n)<0)&&(e=s.We(i,e,r))&&o.Ar(e,r.Ks)})}),u.next(function(){return e.hn.cr(t,s)})},Qu.prototype.Mr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Br(t,n.Oi)})},Qu);function Qu(t,e,n){this.persistence=t,this.qi=e,this.Oi=new br(Ui),this.xi=new zi(function(t){return du(t)},yu),this.Mi=Qi.min(),this.hn=t.Bi(n),this.Ui=t.Qi(),this.Wi=t.ji(),this.Gi=new bu(this.Ui,this.hn,this.persistence.Ki()),this.qi.zi(this.Gi)}function Ku(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Hi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ai("LocalStore","Unexpectedly lost primary lease"),[2]})})}Xu.yr=3e8;var Yu=(Zu.prototype._=function(){return this.Ur._()},Zu.prototype.br=function(t,e){var n=new $u(t,e);this.Ur=this.Ur.add(n),this.Wr=this.Wr.add(n)},Zu.prototype.Gr=function(t,e){var n=this;t.forEach(function(t){return n.br(t,e)})},Zu.prototype.vr=function(t,e){this.Kr(new $u(t,e))},Zu.prototype.zr=function(t,e){var n=this;t.forEach(function(t){return n.vr(t,e)})},Zu.prototype.Hr=function(t){var e=this,n=ur.EMPTY,i=new $u(n,t),r=new $u(n,t+1),o=[];return this.Wr.vt([i,r],function(t){e.Kr(t),o.push(t.key)}),o},Zu.prototype.Yr=function(){var e=this;this.Ur.forEach(function(t){return e.Kr(t)})},Zu.prototype.Kr=function(t){this.Ur=this.Ur.delete(t),this.Wr=this.Wr.delete(t)},Zu.prototype.Xr=function(t){var e=ur.EMPTY,n=new $u(e,t),i=new $u(e,t+1),r=Mr();return this.Wr.vt([n,i],function(t){r=r.add(t.key)}),r},Zu.prototype.Jr=function(t){var e=new $u(t,0),n=this.Ur.Ct(e);return null!==n&&t.isEqual(n.key)},Zu),$u=(Ju.Qr=function(t,e){return ur.P(t.key,e.key)||Ui(t.Zr,e.Zr)},Ju.jr=function(t,e){return Ui(t.Zr,e.Zr)||ur.P(t.key,e.key)},Ju);function Ju(t,e){this.key=t,this.Zr=e}function Zu(){this.Ur=new Pr($u.Qr),this.Wr=new Pr($u.jr)}function ta(t,e){if(0!==e.length)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ma(e.length,"argument")+".")}function ea(t,e,n){if(e.length!==n)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires "+ma(n,"argument")+", but was called with "+ma(e.length,"argument")+".")}function na(t,e,n){if(e.length<n)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ma(n,"argument")+", but was called with "+ma(e.length,"argument")+".")}function ia(t,e,n,i){if(e.length<n||e.length>i)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+ma(e.length,"argument")+".")}function ra(t,e,n,i){ca(t,e,ga(n)+" argument",i)}function oa(t,e,n,i){void 0!==i&&ra(t,e,n,i)}function sa(t,e,n,i){ca(t,e,n+" option",i)}function ua(t,e,n,i){void 0!==i&&sa(t,e,n,i)}function aa(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(fa(s))}var u=fa(n);throw new Wi(Hi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function ha(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid value "+fa(i)+" provided to function "+t+"() for its "+ga(n)+" argument. Acceptable values: "+e.join(", "));return i}function ca(t,e,n,i){if(!("object"===e?la(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=fa(i);throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function la(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function fa(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Si();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function pa(t,e,n){if(void 0===n)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ga(e)+" argument, but it was undefined.")}function da(n,t,i){Fi(t,function(t,e){if(i.indexOf(t)<0)throw new Wi(Hi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function ya(t,e,n,i){var r=fa(i);return new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires its "+ga(n)+" argument to be a "+e+", but it was: "+r)}function va(t,e,n){if(n<=0)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires its "+ga(e)+" argument to be a positive number, but it was: "+n+".")}function ga(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ma(t,e){return t+" "+e+(1===t?"":"s")}function wa(){if("undefined"==typeof Uint8Array)throw new Wi(Hi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ba(){if("undefined"==typeof atob)throw new Wi(Hi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ea(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Wi(Hi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ra("FieldPath","string",e,t[e]),0===t[e].length)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.eo=new or(t)}var _a,Ia=(Na.fromBase64String=function(t){ea("Blob.fromBase64String",arguments,1),ra("Blob.fromBase64String","string",1,t),ba();try{return new Na(lr.fromBase64String(t))}catch(t){throw new Wi(Hi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Na.fromUint8Array=function(t){if(ea("Blob.fromUint8Array",arguments,1),wa(),!(t instanceof Uint8Array))throw ya("Blob.fromUint8Array","Uint8Array",1,t);return new Na(lr.fromUint8Array(t))},Na.prototype.toBase64=function(){return ea("Blob.toBase64",arguments,0),ba(),this.to.toBase64()},Na.prototype.toUint8Array=function(){return ea("Blob.toUint8Array",arguments,0),wa(),this.to.toUint8Array()},Na.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Na.prototype.isEqual=function(t){return this.to.isEqual(t.to)},Na),Ta=(n(Aa,_a=Ea),Aa.documentId=function(){return Aa.so},Aa.prototype.isEqual=function(t){if(!(t instanceof Aa))throw ya("isEqual","FieldPath",1,t);return this.eo.isEqual(t.eo)},Aa);function Aa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _a.call(this,t)||this}function Na(t){ba(),this.to=t}Ta.so=new Ta(or.O().$());var Pa,Sa,Oa,Ra,La,Da,ka,Ua=new RegExp("[~\\*/\\[\\]]"),Va=function(){this.no=this},Ca=(n($a,ka=Va),$a.prototype.ro=function(t){if(2!==t.oo)throw 1===t.oo?t.ho(this.io+"() can only appear at the top level of your update data"):t.ho(this.io+"() cannot be used with set() unless you pass {merge:true}");return t.xe.push(t.path),null},$a.prototype.isEqual=function(t){return t instanceof $a},$a),xa=(n(Ya,Da=Va),Ya.prototype.ro=function(t){return new ss(t.path,zo.instance)},Ya.prototype.isEqual=function(t){return t instanceof Ya},Ya),Ma=(n(Ka,La=Va),Ka.prototype.ro=function(t){var e=new sh({oo:3,methodName:this.io,uo:!0},t.s,t.serializer,t.ignoreUndefinedProperties),n=this.ao.map(function(t){return ch(t,e)}),i=new Wo(n);return new ss(t.path,i)},Ka.prototype.isEqual=function(t){return this===t},Ka),qa=(n(Qa,Ra=Va),Qa.prototype.ro=function(t){var e=new sh({oo:3,methodName:this.io,uo:!0},t.s,t.serializer,t.ignoreUndefinedProperties),n=this.ao.map(function(t){return ch(t,e)}),i=new Xo(n);return new ss(t.path,i)},Qa.prototype.isEqual=function(t){return this===t},Qa),Fa=(n(Xa,Oa=Va),Xa.prototype.ro=function(t){var e=new sh({oo:3,methodName:this.io},t.s,t.serializer,t.ignoreUndefinedProperties),n=ch(this.co,e),i=new Qo(t.serializer,n);return new ss(t.path,i)},Xa.prototype.isEqual=function(t){return this===t},Xa),ja=(n(Wa,Sa=Va),Wa.delete=function(){return ta("FieldValue.delete",arguments),new Ga(new Ca("FieldValue.delete"))},Wa.serverTimestamp=function(){return ta("FieldValue.serverTimestamp",arguments),new Ga(new xa("FieldValue.serverTimestamp"))},Wa.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return na("FieldValue.arrayUnion",arguments,1),new Ga(new Ma("FieldValue.arrayUnion",t))},Wa.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return na("FieldValue.arrayRemove",arguments,1),new Ga(new qa("FieldValue.arrayRemove",t))},Wa.increment=function(t){return ra("FieldValue.increment","number",1,t),ea("FieldValue.increment",arguments,1),new Ga(new Fa("FieldValue.increment",t))},Wa),Ga=(n(Ha,Pa=ja),Ha.prototype.ro=function(t){return this.no.ro(t)},Ha.prototype.isEqual=function(t){return t instanceof Ha&&this.no.isEqual(t.no)},Ha),Ba=(Object.defineProperty(za.prototype,"latitude",{get:function(){return this.lo},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"longitude",{get:function(){return this._o},enumerable:!0,configurable:!0}),za.prototype.isEqual=function(t){return this.lo===t.lo&&this._o===t._o},za.prototype.T=function(t){return Ui(this.lo,t.lo)||Ui(this._o,t._o)},za);function za(t,e){if(ea("GeoPoint",arguments,2),ra("GeoPoint","number",1,t),ra("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Wi(Hi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Wi(Hi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.lo=t,this._o=e}function Ha(t){var e=this;return(e=Pa.call(this)||this).no=t,e.io=t.io,e}function Wa(){return null!==Sa&&Sa.apply(this,arguments)||this}function Xa(t,e){var n=this;return(n=Oa.call(this)||this).io=t,n.co=e,n}function Qa(t,e){var n=this;return(n=Ra.call(this)||this).io=t,n.ao=e,n}function Ka(t,e){var n=this;return(n=La.call(this)||this).io=t,n.ao=e,n}function Ya(t){var e=this;return(e=Da.call(this)||this).io=t,e}function $a(t){var e=this;return(e=ka.call(this)||this).io=t,e}function Ja(t){return new Po(t,!0)}var Za=/^__.*__$/,th=function(t,e,n){this.fo=t,this.do=e,this.wo=n},eh=(rh.prototype.To=function(t,e){var n=[];return null!==this.xe?n.push(new cs(t,this.data,this.xe,e)):n.push(new hs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ls(t,this.fieldTransforms)),n},rh),nh=(ih.prototype.To=function(t,e){var n=[new cs(t,this.data,this.xe,e)];return 0<this.fieldTransforms.length&&n.push(new ls(t,this.fieldTransforms)),n},ih);function ih(t,e,n){this.data=t,this.xe=e,this.fieldTransforms=n}function rh(t,e,n){this.data=t,this.xe=e,this.fieldTransforms=n}function oh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Si()}}var sh=(Object.defineProperty(hh.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(hh.prototype,"oo",{get:function(){return this.settings.oo},enumerable:!0,configurable:!0}),hh.prototype.mo=function(t){return new hh(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.xe)},hh.prototype.Io=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.mo({path:n,uo:!1});return i.Ro(t),i},hh.prototype.Ao=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.mo({path:n,uo:!1});return i.Eo(),i},hh.prototype.Po=function(t){return this.mo({path:void 0,uo:!0})},hh.prototype.ho=function(t){var e=!this.path||this.path._()?"":" (found in field "+this.path.toString()+")";return new Wi(Hi.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},hh.prototype.contains=function(e){return void 0!==this.xe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},hh.prototype.Eo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ro(this.path.get(t))},hh.prototype.Ro=function(t){if(0===t.length)throw this.ho("Document fields must not be empty");if(oh(this.oo)&&Za.test(t))throw this.ho('Document fields cannot begin and end with "__"')},hh),uh=(ah.prototype.Vo=function(t,e,n){void 0===n&&(n={});var i=this.po(n.merge||n.mergeFields?2:0,t);ph("Data must be an object, but it was:",i,e);var r,o,s=lh(e,i);if(n.merge)r=new os(i.xe),o=i.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],l=void 0;if(c instanceof Ea)l=c.eo;else{if("string"!=typeof c)throw Si();l=yh(t,c)}if(!i.contains(l))throw new Wi(Hi.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");vh(u,l)||u.push(l)}r=new os(u),o=i.fieldTransforms.filter(function(t){return r.Ge(t.field)})}else r=null,o=i.fieldTransforms;return new eh(new ds(s),r,o)},ah.prototype.yo=function(o,t){var s=this.po(1,o);ph("Data must be an object, but it was:",s,t);var u=[],a=new ys;Fi(t,function(t,e){var n=yh(o,t),i=s.Ao(n);if(e instanceof Va&&e.no instanceof Ca)u.push(n);else{var r=ch(e,i);null!=r&&(u.push(n),a.set(n,r))}});var e=new os(u);return new nh(a.es(),e,s.fieldTransforms)},ah.prototype.bo=function(t,e,n,i){var r=this.po(1,t),o=[dh(t,e)],s=[n];if(i.length%2!=0)throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(dh(t,i[u])),s.push(i[u+1]);for(var a=[],h=new ys,c=o.length-1;0<=c;--c)if(!vh(a,o[c])){var l=o[c],f=s[c],p=r.Ao(l);if(f instanceof Va&&f.no instanceof Ca)a.push(l);else{var d=ch(f,p);null!=d&&(a.push(l),h.set(l,d))}}var y=new os(a);return new nh(h.es(),y,r.fieldTransforms)},ah.prototype.po=function(t,e){return new sh({oo:t,methodName:e,path:or.k,uo:!1},this.s,this.serializer,this.ignoreUndefinedProperties)},ah.prototype.vo=function(t,e,n){return void 0===n&&(n=!1),ch(e,this.po(n?4:3,t))},ah);function ah(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ja(t)}function hh(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Eo(),this.fieldTransforms=r||[],this.xe=o||[]}function ch(s,t){if(fh(s))return ph("Unsupported field value:",t,s),lh(s,t);if(s instanceof Va)return function(t,e){if(!oh(e.oo))throw e.ho(t.io+"() can only be used with update() and set()");if(!e.path)throw e.ho(t.io+"() is not currently supported inside arrays");var n=t.ro(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.xe.push(t.path),s instanceof Array){if(t.settings.uo&&4!==t.oo)throw t.ho("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=ch(r[i],t.Po(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return n=e.serializer,"number"==typeof(r=i=t)&&Number.isInteger(r)&&!cr(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER?So(i):Oo(n,i);var n,i,r;if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var o=Xi.fromDate(t);return{timestampValue:Ro(e.serializer,o)}}if(t instanceof Xi){var s=new Xi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ro(e.serializer,s)}}if(t instanceof Ba)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ia)return{bytesValue:Lo(e.serializer,t)};if(t instanceof th){var u=e.s,a=t.fo;if(!a.isEqual(u))throw e.ho("Document reference is for database "+a.projectId+"/"+a.database+" but should be for database "+u.projectId+"/"+u.database);return{referenceValue:Uo(t.fo||e.s,t.do.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ho("Unsupported field value: "+fa(t))}(s,t)}function lh(t,i){var r={};return ji(t)?i.path&&0<i.path.length&&i.xe.push(i.path):Fi(t,function(t,e){var n=ch(e,i.Io(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function fh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Xi||t instanceof Ba||t instanceof Ia||t instanceof th||t instanceof Va)}function ph(t,e,n){if(!fh(n)||!la(n)){var i=fa(n);throw"an object"===i?e.ho(t+" a custom object"):e.ho(t+" "+i)}}function dh(t,e){if(e instanceof Ea)return e.eo;if("string"==typeof e)return yh(t,e);throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function yh(t,e){try{return function(e){if(0<=e.search(Ua))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ta.bind.apply(Ta,v([void 0],e.split("."))))}catch(t){throw new Wi(Hi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).eo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function vh(t,e){return t.some(function(t){return t.isEqual(e)})}var gh=(mh.prototype.So=function(){return null!=this.uid},mh.prototype.Co=function(){return this.So()?"uid:"+this.uid:"anonymous-user"},mh.prototype.isEqual=function(t){return t.uid===this.uid},mh);function mh(t){this.uid=t}gh.UNAUTHENTICATED=new gh(null),gh.Do=new gh("google-credentials-uid"),gh.Fo=new gh("first-party-uid");function wh(t,e){this.user=e,this.type="OAuth",this.$o={},this.$o.Authorization="Bearer "+t}function bh(t){this.key=t}function Eh(t){this.key=t}function _h(t,e,n){this.query=t,this.targetId=e,this.view=n}function Ih(t){this.key=t,this.Ru=!1}function Th(){this.Ju=void 0,this.Zu=[]}var Ah,Nh,Ph,Sh,Oh=(vc.prototype.getToken=function(){return Promise.resolve(null)},vc.prototype.ko=function(){},vc.prototype.Lo=function(t){(this.No=t)(gh.UNAUTHENTICATED)},vc.prototype.qo=function(){this.No=null},vc),Rh=(yc.prototype.getToken=function(){var e=this,n=this.Mo,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Mo!==n?(Ai("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Oi("string"==typeof t.accessToken),new wh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},yc.prototype.ko=function(){this.forceRefresh=!0},yc.prototype.Lo=function(t){this.No=t,this.xo&&t(this.currentUser)},yc.prototype.qo=function(){this.auth&&this.auth.removeAuthTokenListener(this.Oo),this.Oo=null,this.No=null},yc.prototype.Bo=function(){var t=this.auth&&this.auth.getUid();return Oi(null===t||"string"==typeof t),new gh(t)},yc),Lh=(Object.defineProperty(dc.prototype,"$o",{get:function(){var t={"X-Goog-AuthUser":this.Qo},e=this.Uo.auth.Wo([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),dc),Dh=(pc.prototype.getToken=function(){return Promise.resolve(new Lh(this.Uo,this.Qo))},pc.prototype.Lo=function(t){t(gh.Fo)},pc.prototype.qo=function(){},pc.prototype.ko=function(){},pc),kh=(fc.prototype.Yo=function(){return 1===this.state||2===this.state||4===this.state},fc.prototype.Xo=function(){return 2===this.state},fc.prototype.start=function(){3!==this.state?this.auth():this.Jo()},fc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Yo()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},fc.prototype.Zo=function(){this.state=0,this._i.reset()},fc.prototype.th=function(){var t=this;this.Xo()&&null===this.Ho&&(this.Ho=this.Fn.Qn(this.jo,6e4,function(){return t.eh()}))},fc.prototype.sh=function(t){this.nh(),this.stream.send(t)},fc.prototype.eh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Xo()?[2,this.close(0)]:[2]})})},fc.prototype.nh=function(){this.Ho&&(this.Ho.cancel(),this.Ho=null)},fc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.nh(),this._i.cancel(),this.zo++,3!==e?this._i.reset():n&&n.code===Hi.RESOURCE_EXHAUSTED?(Ni(n.toString()),Ni("Using maximum backoff delay to prevent overloading the backend."),this._i.Mn()):n&&n.code===Hi.UNAUTHENTICATED&&this.Ko.ko(),null!==this.stream&&(this.ih(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.rh(n)];case 1:return t.sent(),[2]}})})},fc.prototype.ih=function(){},fc.prototype.auth=function(){var n=this;this.state=1;var t=this.oh(this.zo),e=this.zo;this.Ko.getToken().then(function(t){n.zo===e&&n.hh(t)},function(e){t(function(){var t=new Wi(Hi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ah(t)})})},fc.prototype.hh=function(t){var e=this,n=this.oh(this.zo);this.stream=this.uh(t),this.stream.lh(function(){n(function(){return e.state=2,e.listener.lh()})}),this.stream.rh(function(t){n(function(){return e.ah(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},fc.prototype.Jo=function(){var t=this;this.state=4,this._i.Bn(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},fc.prototype.ah=function(t){return Ai("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},fc.prototype.oh=function(e){var n=this;return function(t){n.Fn.ii(function(){return n.zo===e?t():(Ai("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},fc),Uh=(n(lc,Ph=kh),lc.prototype.uh=function(t){return this.Go._h("Listen",t)},lc.prototype.onMessage=function(t){this._i.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Si(),u=e.targetChange.targetIds||[],a=Do(t,e.targetChange.resumeToken),h=e.targetChange.cause,c=h&&(r=void 0===(i=h).code?Hi.UNKNOWN:wr(i.code),new Wi(r,i.message||""));n=new Br(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Co(t,l.document.name),p=ko(l.document.updateTime),d=new ds({mapValue:{fields:l.document.fields}}),y=new Ms(f,p,d,{}),v=l.targetIds||[],g=l.removedTargetIds||[];n=new jr(v,g,y.key,y)}else if("documentDelete"in e){e.documentDelete;var m=e.documentDelete;m.document;var w=Co(t,m.document),b=m.readTime?ko(m.readTime):Qi.min(),E=new qs(w,b),_=m.removedTargetIds||[];n=new jr([],_,E.key,E)}else if("documentRemove"in e){e.documentRemove;var I=e.documentRemove;I.document;var T=Co(t,I.document),A=I.removedTargetIds||[];n=new jr([],A,T,null)}else{if(!("filter"in e))return Si();e.filter;var N=e.filter;N.targetId;var P=N.count||0,S=new pr(P),O=N.targetId;n=new Gr(O,S)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Qi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Qi.min():ko(e.readTime)}(t);return this.listener.fh(e,n)},lc.prototype.dh=function(t){var e,n,i,r,o={};o.database=Mo(this.serializer),o.addTarget=(e=this.serializer,r=(n=t).target,(i=vu(r)?{documents:{documents:[xo(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=xo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=xo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof Gs?function(t){if("=="===t.op){if(Io(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NAN"}};if(_o(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Go(t.field),op:(e=t.op,No[e]),value:t.value}};var e}(t):Si()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Go((e=t).field),direction:(n=e.dir,Ao[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Oe||hr(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=jo(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.K()&&(i.resumeToken=Lo(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.Y){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Si()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.sh(o)},lc.prototype.wh=function(t){var e={};e.database=Mo(this.serializer),e.removeTarget=t,this.sh(e)},lc),Vh=(n(cc,Nh=kh),Object.defineProperty(cc.prototype,"Eh",{get:function(){return this.Th},enumerable:!0,configurable:!0}),cc.prototype.start=function(){this.Th=!1,this.lastStreamToken=lr.H,Nh.prototype.start.call(this)},cc.prototype.ih=function(){this.Th&&this.mh([])},cc.prototype.uh=function(t){return this.Go._h("Write",t)},cc.prototype.onMessage=function(t){if(Oi(!!t.streamToken),this.lastStreamToken=Do(this.serializer,t.streamToken),this.Th){this._i.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Oi(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?ko(t.updateTime):ko(e);n.isEqual(Qi.min())&&(n=ko(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Zo(n,i)}(t,r)})):[]),n=ko(t.commitTime);return this.listener.Ih(n,e)}var i,r;return Oi(!t.writeResults||0===t.writeResults.length),this.Th=!0,this.listener.Rh()},cc.prototype.Ah=function(){var t={};t.database=Mo(this.serializer),this.sh(t)},cc.prototype.mh=function(t){var e=this,n={streamToken:Lo(this.serializer,this.lastStreamToken),writes:t.map(function(t){return Fo(e.serializer,t)})};this.sh(n)},cc),Ch=(n(hc,Ah=function(){this.Ph=void 0}),hc.prototype.ph=function(){if(this.Vh)throw new Wi(Hi.FAILED_PRECONDITION,"The client has already been terminated.")},hc.prototype.yh=function(e,n){var i=this;return this.ph(),this.credentials.getToken().then(function(t){return i.Go.yh(e,n,t)}).catch(function(t){throw t.code===Hi.UNAUTHENTICATED&&i.credentials.ko(),t})},hc.prototype.gh=function(e,n){var i=this;return this.ph(),this.credentials.getToken().then(function(t){return i.Go.gh(e,n,t)}).catch(function(t){throw t.code===Hi.UNAUTHENTICATED&&i.credentials.ko(),t})},hc),xh=(ac.prototype.Fh=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.$h(),0<this.mutations.length)throw new Wi(Hi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return d(this,void 0,void 0,function(){var r,e,n,o,i;return y(this,function(t){switch(t.label){case 0:return r=Ri(s),e={database:Mo(r.serializer),documents:u.map(function(t){return Vo(r.serializer,t)})},[4,r.gh("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Oi(!!e.found),e.found.name,e.found.updateTime;var n=Co(t,e.found.name),i=ko(e.found.updateTime),r=new ds({mapValue:{fields:e.found.fields}});return new Ms(n,i,r,{})}(e,n):"missing"in n?function(t,e){Oi(!!e.missing),Oi(!!e.readTime);var n=Co(t,e.missing),i=ko(e.readTime);return new qs(n,i)}(e,n):Si());o.set(i.key.toString(),i)}),i=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Oi(!!e),i.push(e)}),i)]}})})}(this.bh,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof qs||t instanceof Ms?n.Nh(t):Si()}),e)]}})})},ac.prototype.set=function(t,e){this.write(e.To(t,this.Ue(t))),this.Dh.add(t)},ac.prototype.update=function(t,e){try{this.write(e.To(t,this.kh(t)))}catch(t){this.Ch=t}this.Dh.add(t)},ac.prototype.delete=function(t){this.write([new fs(t,this.Ue(t))]),this.Dh.add(t)},ac.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.$h(),this.Ch)throw this.Ch;return e=this.vh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ur(Yi.N(e));i.mutations.push(new ps(n,i.Ue(n)))}),[4,function(i,r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=Ri(i),n={database:Mo(e.serializer),writes:r.map(function(t){return Fo(e.serializer,t)})},[4,e.yh("Commit",n)];case 1:return t.sent(),[2]}})})}(this.bh,this.mutations)];case 1:return t.sent(),this.Sh=!0,[2]}})})},ac.prototype.Nh=function(t){var e;if(t instanceof Ms)e=t.version;else{if(!(t instanceof qs))throw Si();e=Qi.min()}var n=this.vh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Wi(Hi.ABORTED,"Document version changed between two reads.")}else this.vh.set(t.key.toString(),e)},ac.prototype.Ue=function(t){var e=this.vh.get(t.toString());return!this.Dh.has(t)&&e?us.updateTime(e):us.Ke()},ac.prototype.kh=function(t){var e=this.vh.get(t.toString());if(this.Dh.has(t)||!e)return us.exists(!0);if(e.isEqual(Qi.min()))throw new Wi(Hi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return us.updateTime(e)},ac.prototype.write=function(t){this.$h(),this.mutations=this.mutations.concat(t)},ac.prototype.$h=function(){},ac),Mh=(uc.prototype.Mh=function(){var t=this;0===this.qh&&(this.Bh("Unknown"),this.Oh=this.Xn.Qn("online_state_timeout",1e4,function(){return t.Oh=null,t.Uh("Backend didn't respond within 10 seconds."),t.Bh("Offline"),Promise.resolve()}))},uc.prototype.Qh=function(t){"Online"===this.state?this.Bh("Unknown"):(this.qh++,1<=this.qh&&(this.Wh(),this.Uh("Connection failed 1 times. Most recent error: "+t.toString()),this.Bh("Offline")))},uc.prototype.set=function(t){this.Wh(),this.qh=0,"Online"===t&&(this.xh=!1),this.Bh(t)},uc.prototype.Bh=function(t){t!==this.state&&(this.state=t,this.Lh(t))},uc.prototype.Uh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.xh?(Ni(e),this.xh=!1):Ai("OnlineStateTracker",e)},uc.prototype.Wh=function(){null!==this.Oh&&(this.Oh.cancel(),this.Oh=null)},uc),qh=(sc.prototype.start=function(){return this.enableNetwork()},sc.prototype.enableNetwork=function(){return this.Hh.delete(0),this.ua()},sc.prototype.ua=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Jh()?(this.ca()?this.la():this.ta.set("Unknown"),[4,this._a()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Hh.add(0),[4,this.fa()];case 1:return t.sent(),this.ta.set("Offline"),[2]}})})},sc.prototype.fa=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.ra.stop()];case 1:return t.sent(),[4,this.ea.stop()];case 2:return t.sent(),0<this.Gh.length&&(Ai("RemoteStore","Stopping write stream with "+this.Gh.length+" pending writes"),this.Gh=[]),this.da(),[2]}})})},sc.prototype.wa=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Ai("RemoteStore","RemoteStore shutting down."),this.Hh.add(5),[4,this.fa()];case 1:return t.sent(),this.Yh.wa(),this.ta.set("Unknown"),[2]}})})},sc.prototype.listen=function(t){this.Kh.has(t.targetId)||(this.Kh.set(t.targetId,t),this.ca()?this.la():this.ea.Xo()&&this.Ta(t))},sc.prototype.Ea=function(t){this.Kh.delete(t),this.ea.Xo()&&this.ma(t),0===this.Kh.size&&(this.ea.Xo()?this.ea.th():this.Jh()&&this.ta.set("Unknown"))},sc.prototype.qe=function(t){return this.Kh.get(t)||null},sc.prototype.Le=function(t){return this.Ia.Le(t)},sc.prototype.Ta=function(t){this.zh.de(t.targetId),this.ea.dh(t)},sc.prototype.ma=function(t){this.zh.de(t),this.ea.wh(t)},sc.prototype.la=function(){this.zh=new Yr(this),this.ea.start(),this.ta.Mh()},sc.prototype.ca=function(){return this.Jh()&&!this.ea.Yo()&&0<this.Kh.size},sc.prototype.Jh=function(){return 0===this.Hh.size},sc.prototype.da=function(){this.zh=null},sc.prototype.sa=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Kh.forEach(function(t,e){n.Ta(t)}),[2]})})},sc.prototype.na=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.da(),this.ca()?(this.ta.Qh(e),this.la()):this.ta.set("Unknown"),[2]})})},sc.prototype.ia=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.ta.set("Online"),!(r instanceof Br&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Ra(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Ai("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Aa(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof jr?this.zh.Pe(r):r instanceof Gr?this.zh.Ce(r):this.zh.ye(r),o.isEqual(Qi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.jh._r()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Pa(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ai("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Aa(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},sc.prototype.Aa=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!Mu(n))throw n;return this.Hh.add(1),[4,this.fa()];case 1:return t.sent(),this.ta.set("Offline"),i=i||function(){return e.jh._r()},this.Xn.Ri(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Ai("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.Hh.delete(1),[4,this.ua()];case 2:return t.sent(),[2]}})})}),[2]}})})},sc.prototype.Va=function(e){var n=this;return e().catch(function(t){return n.Aa(t,e)})},sc.prototype.Pa=function(i){var r=this,t=this.zh.$e(i);return t.Qt.forEach(function(t,e){if(0<t.resumeToken.K()){var n=r.Kh.get(e);n&&r.Kh.set(e,n.Z(t.resumeToken,i))}}),t.Wt.forEach(function(t){var e=r.Kh.get(t);if(e){r.Kh.set(t,e.Z(lr.H,e.X)),r.ma(t);var n=new vr(e.target,t,1,e.sequenceNumber);r.Ta(n)}}),this.Ia.dr(t)},sc.prototype.Ra=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.Kh.has(r)?[4,this.Ia.pa(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.Kh.delete(r),this.zh.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},sc.prototype._a=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:e=0<this.Gh.length?this.Gh[this.Gh.length-1].batchId:-1,t.label=1;case 1:if(!this.ya())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.jh.Sr(e)];case 3:return null===(n=t.sent())?(0===this.Gh.length&&this.ra.th(),[3,7]):(e=n.batchId,this.ga(n),[3,6]);case 4:return i=t.sent(),[4,this.Aa(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.ba()&&this.va(),[2]}})})},sc.prototype.ya=function(){return this.Jh()&&this.Gh.length<10},sc.prototype.Sa=function(){return this.Gh.length},sc.prototype.ga=function(t){this.Gh.push(t),this.ra.Xo()&&this.ra.Eh&&this.ra.mh(t.mutations)},sc.prototype.ba=function(){return this.Jh()&&!this.ra.Yo()&&0<this.Gh.length},sc.prototype.va=function(){this.ra.start()},sc.prototype.oa=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ra.Ah(),[2]})})},sc.prototype.aa=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this.Gh;e<n.length;e++)i=n[e],this.ra.mh(i.mutations);return[2]})})},sc.prototype.Ih=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Gh.shift(),n=mu.from(e,r,o),[4,this.Va(function(){return i.Ia.Ca(n)})];case 1:return t.sent(),[4,this._a()];case 2:return t.sent(),[2]}})})},sc.prototype.ha=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.ra.Eh?[4,this.Da(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ba()&&this.va(),[2]}})})},sc.prototype.Da=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return mr(n=r.code)&&n!==Hi.ABORTED?(e=this.Gh.shift(),this.ra.Zo(),[4,this.Va(function(){return i.Ia.Fa(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this._a()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},sc.prototype.$a=function(){return new xh(this.bh)},sc.prototype.Zh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Hh.add(4),[4,this.fa()];case 1:return t.sent(),this.ta.set("Unknown"),this.Hh.delete(4),[4,this.ua()];case 2:return t.sent(),[2]}})})},sc.prototype.Na=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Xn.Pi(),Ai("RemoteStore","RemoteStore received new credentials"),this.Hh.add(3),[4,this.fa()];case 1:return t.sent(),this.ta.set("Unknown"),[4,this.Ia.Na(e)];case 2:return t.sent(),this.Hh.delete(3),[4,this.ua()];case 3:return t.sent(),[2]}})})},sc.prototype.ka=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Hh.delete(2),[4,this.ua()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Hh.add(2),[4,this.fa()]);case 3:t.sent(),this.ta.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},sc),Fh=(oc.prototype.La=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},oc.prototype.qa=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},oc.prototype.Oa=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},oc),jh=(rc.prototype.Ba=function(t){},rc.prototype.Ua=function(t,e,n){},rc.prototype.Qa=function(t){return this.xa.La(t),this.Ma[t]||"not-current"},rc.prototype.Wa=function(t,e,n){this.Ma[t]=e},rc.prototype.ja=function(t){this.xa.qa(t)},rc.prototype.Ga=function(t){return this.xa.activeTargetIds.has(t)},rc.prototype.Ka=function(t){delete this.Ma[t]},rc.prototype.za=function(){return this.xa.activeTargetIds},rc.prototype.Ha=function(t){return this.xa.activeTargetIds.has(t)},rc.prototype.start=function(){return this.xa=new Fh,Promise.resolve()},rc.prototype.Hi=function(t,e,n){},rc.prototype.Ya=function(t){},rc.prototype.wa=function(){},rc.prototype.Cn=function(t){},rc),Gh=(Object.defineProperty(ic.prototype,"eu",{get:function(){return this.Xa},enumerable:!0,configurable:!0}),ic.prototype.su=function(t,e){var u=this,a=e?e.nu:new Hr,h=e?e.tu:this.tu,c=e?e.xt:this.xt,l=h,f=!1,p=this.query.ks()&&h.size===this.query.limit?h.last():null,d=this.query.Ls()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),i=e instanceof Ms?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.xt.has(n.key),o=!!i&&(i.Xe||u.xt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.iu(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.Cs(i,p)||d&&u.query.Cs(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.ks()||this.query.Ls())for(;l.size>this.query.limit;){var n=this.query.ks()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{tu:l,nu:a,ru:f,xt:c}},ic.prototype.iu=function(t,e){return t.Xe&&e.hasCommittedMutations&&!e.Xe},ic.prototype.ou=function(t,e,n){var o=this,i=this.tu;this.tu=t.tu,this.xt=t.xt;var r=t.nu.qt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.Cs(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Si()}}var i,r}),this.hu(n);var s=e?this.au():[],u=0===this.Za.size&&this.Ht?1:0,a=u!==this.Ja;return this.Ja=u,0!==r.length||a?{snapshot:new Wr(this.query,t.tu,i,r,t.xt,0==u,a,!1),uu:s}:{uu:s}},ic.prototype.cu=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.ou({tu:this.tu,nu:new Hr,xt:this.xt,ru:!1},!1)):{uu:[]}},ic.prototype.lu=function(t){return!this.Xa.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).Xe},ic.prototype.hu=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Xa=e.Xa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Xa=e.Xa.delete(t)}),this.Ht=t.Ht)},ic.prototype.au=function(){var e=this;if(!this.Ht)return[];var n=this.Za;this.Za=Mr(),this.tu.forEach(function(t){e.lu(t.key)&&(e.Za=e.Za.add(t.key))});var i=[];return n.forEach(function(t){e.Za.has(t)||i.push(new Eh(t))}),this.Za.forEach(function(t){n.has(t)||i.push(new bh(t))}),i},ic.prototype._u=function(t){this.Xa=t.xr,this.Za=Mr();var e=this.su(t.documents);return this.ou(e,!0)},ic.prototype.fu=function(){return Wr.Ut(this.query,this.tu,this.xt,0===this.Ja)},ic),Bh=(nc.prototype.wu=function(){this.Tu()},nc.prototype.Tu=function(){var t=this;this._i.Bn(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new xh(this.bh),(n=this.Eu(e))&&n.then(function(t){i.Xn.ii(function(){return e.commit().then(function(){i.ti.resolve(t)}).catch(function(t){i.mu(t)})})}).catch(function(t){i.mu(t)}),[2]})})})},nc.prototype.Eu=function(t){try{var e=this.updateFunction(t);return!hr(e)&&e.catch&&e.then?e:(this.ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ti.reject(t),null}},nc.prototype.mu=function(t){var e=this;0<this.du&&this.Iu(t)?(--this.du,this.Xn.ii(function(){return e.Tu(),Promise.resolve()})):this.ti.reject(t)},nc.prototype.Iu=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!mr(e)},nc),zh=(Object.defineProperty(ec.prototype,"Nu",{get:function(){return!0},enumerable:!0,configurable:!0}),ec.prototype.subscribe=function(t){this.pu=t},ec.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.ku("listen()"),(i=this.yu.get(s))?(e=i.targetId,this.Pu.Qa(e),n=i.view.fu(),[3,4]):[3,1];case 1:return[4,this.jh.Fr(s.Ss())];case 2:return r=t.sent(),o=this.Pu.Qa(r.targetId),e=r.targetId,[4,this.Lu(s,e,"current"===o)];case 3:n=t.sent(),this.Nu&&this.Au.listen(r),t.label=4;case 4:return[2,n]}})})},ec.prototype.Lu=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.jh.qr(u,!0)];case 1:return e=t.sent(),n=new Gh(u,e.xr),i=n.su(e.documents),r=Qr.zt(a,h&&"Offline"!==this.onlineState),o=n.ou(i,this.Nu,r),this.qu(a,o.uu),s=new _h(u,a,n),[2,(this.yu.set(u,s),this.gu.has(a)?this.gu.get(a).push(u):this.gu.set(a,[u]),o.snapshot)]}})})},ec.prototype.Ea=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ku("unlisten()"),e=this.yu.get(r),1<(n=this.gu.get(e.targetId)).length?[2,(this.gu.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.yu.delete(r))]:this.Nu?(this.Pu.ja(e.targetId),this.Pu.Ha(e.targetId)?[3,2]:[4,this.jh.Lr(e.targetId,!1).then(function(){i.Pu.Ka(e.targetId),i.Au.Ea(e.targetId),i.Ou(e.targetId)}).catch(Ku)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Ou(e.targetId),[4,this.jh.Lr(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},ec.prototype.write=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:this.ku("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.jh.tr(r)];case 2:return e=t.sent(),this.Pu.Ba(e.batchId),this.xu(e.batchId,o),[4,this.Mu(e.sr)];case 3:return t.sent(),[4,this.Au._a()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=zu(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},ec.prototype.runTransaction=function(t,e,n){new Bh(t,this.bh,e,n).wu()},ec.prototype.dr=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.ku("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.jh.dr(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=i.Su.get(e);n&&(Oi(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.Ru=!0:0<t.Xt.size?Oi(n.Ru):0<t.Jt.size&&(Oi(n.Ru),n.Ru=!1))}),[4,this.Mu(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ec.prototype.cu=function(i,t){this.ku("applyOnlineStateChange()");var r=[];this.yu.forEach(function(t,e){var n=e.view.cu(i);n.snapshot&&r.push(n.snapshot)}),this.pu.Bu(i),this.pu.fh(r),this.onlineState=i},ec.prototype.pa=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ku("rejectListens()"),this.Pu.Wa(u,"rejected",a),e=this.Su.get(u),(n=e&&e.key)?(i=(i=new br(ur.P)).et(n,new qs(n,Qi.min())),r=Mr().add(n),o=new Xr(Qi.min(),new Map,new Pr(Ui),i,r),[4,this.dr(o)]):[3,2];case 1:return t.sent(),this.vu=this.vu.remove(n),this.Su.delete(u),this.Uu(),[3,4];case 2:return[4,this.jh.Lr(u,!1).then(function(){return s.Ou(u,a)}).catch(Ku)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},ec.prototype.Ca=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.ku("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.jh.nr(i)];case 2:return n=t.sent(),this.Qu(e,null),this.Wu(e),this.Pu.Ua(e,"acknowledged"),[4,this.Mu(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ec.prototype.Fa=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.ku("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.jh.ar(n)];case 2:return e=t.sent(),this.Qu(n,i),this.Wu(n),this.Pu.Ua(n,"rejected",i),[4,this.Mu(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ec.prototype.ju=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:this.Au.Jh()||Ai("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.jh.lr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Fu.get(e)||[]).push(o),this.Fu.set(e,n),[3,4]);case 3:return i=t.sent(),r=zu(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},ec.prototype.Wu=function(t){(this.Fu.get(t)||[]).forEach(function(t){t.resolve()}),this.Fu.delete(t)},ec.prototype.Gu=function(e){this.Fu.forEach(function(t){t.forEach(function(t){t.reject(new Wi(Hi.CANCELLED,e))})}),this.Fu.clear()},ec.prototype.xu=function(t,e){var n=this.Du[this.currentUser.Co()];n=(n=n||new br(Ui)).et(t,e),this.Du[this.currentUser.Co()]=n},ec.prototype.Qu=function(t,e){var n=this.Du[this.currentUser.Co()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Du[this.currentUser.Co()]=n}},ec.prototype.Ou=function(t,e){var n=this;void 0===e&&(e=null),this.Pu.ja(t);for(var i=0,r=this.gu.get(t);i<r.length;i++){var o=r[i];this.yu.delete(o),e&&this.pu.Ku(o,e)}this.gu.delete(t),this.Nu&&this.Cu.Hr(t).forEach(function(t){n.Cu.Jr(t)||n.zu(t)})},ec.prototype.zu=function(t){var e=this.vu.get(t);null!==e&&(this.Au.Ea(e),this.vu=this.vu.remove(t),this.Su.delete(e),this.Uu())},ec.prototype.qu=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof bh?(this.Cu.br(r.key,t),this.Hu(r)):r instanceof Eh?(Ai("SyncEngine","Document no longer in limbo: "+r.key),this.Cu.vr(r.key,t),this.Cu.Jr(r.key)||this.zu(r.key)):Si()}},ec.prototype.Hu=function(t){var e=t.key;this.vu.get(e)||(Ai("SyncEngine","New document in limbo: "+e),this.bu.push(e),this.Uu())},ec.prototype.Uu=function(){for(;0<this.bu.length&&this.vu.size<this.Vu;){var t=this.bu.shift(),e=this.$u.next();this.Su.set(e,new Ih(t)),this.vu=this.vu.et(t,e),this.Au.listen(new vr(js.ms(t.path).Ss(),e,2,_u.Dn))}},ec.prototype.Yu=function(){return this.vu},ec.prototype.Xu=function(){return this.bu},ec.prototype.Mu=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.yu.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.su(i);return n.ru?u.jh.qr(r.query,!1).then(function(t){var e=t.documents;return r.view.su(e,n)}):n}).then(function(t){var e=a&&a.Qt.get(r.targetId),n=r.view.ou(t,u.Nu,e);if(u.qu(r.targetId,n.uu),n.snapshot){u.Nu&&u.Pu.Wa(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Eu.gn(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.pu.fh(o),[4,this.jh.gr(s)];case 2:return t.sent(),[2]}})})},ec.prototype.ku=function(t){},ec.prototype.Na=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Ai("SyncEngine","User change. New user:",n.Co()),[4,this.jh.Hi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.Gu("'waitForPendingWrites' promise is rejected due to a user change."),this.Pu.Hi(n,e.Ji,e.Zi),[4,this.Mu(e.Xi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ec.prototype.enableNetwork=function(){return this.Au.enableNetwork()},ec.prototype.disableNetwork=function(){return this.Au.disableNetwork()},ec.prototype.Le=function(t){var e=this.Su.get(t);if(e&&e.Ru)return Mr().add(e.key);var n=Mr(),i=this.gu.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.yu.get(s);n=n.Dt(u.view.eu)}return n},ec),Hh=(tc.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.tc.get(e))||(n=!0,i=new Th),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Ia.listen(e)];case 2:return r.Ju=t.sent(),[3,4];case 3:return o=t.sent(),s=zu(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.tc.set(e,i),i.Zu.push(u),u.cu(this.onlineState),i.Ju&&u.sc(i.Ju)&&this.nc(),[2]}})})},tc.prototype.Ea=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.tc.get(e))&&0<=(r=i.Zu.indexOf(o))&&(i.Zu.splice(r,1),n=0===i.Zu.length),n?[2,(this.tc.delete(e),this.Ia.Ea(e))]:[2]})})},tc.prototype.fh=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.tc.get(o);if(s){for(var u=0,a=s.Zu;u<a.length;u++)a[u].sc(r)&&(e=!0);s.Ju=r}}e&&this.nc()},tc.prototype.Ku=function(t,e){var n=this.tc.get(t);if(n)for(var i=0,r=n.Zu;i<r.length;i++)r[i].onError(e);this.tc.delete(t)},tc.prototype.Bu=function(r){this.onlineState=r;var o=!1;this.tc.forEach(function(t,e){for(var n=0,i=e.Zu;n<i.length;n++)i[n].cu(r)&&(o=!0)}),o&&this.nc()},tc.prototype.ic=function(t){this.ec.add(t),t.next()},tc.prototype.rc=function(t){this.ec.delete(t)},tc.prototype.nc=function(){this.ec.forEach(function(t){t.next()})},tc),Wh=(Zh.prototype.sc=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Wr(t.query,t.docs,t.Ot,e,t.xt,t.fromCache,t.Mt,!0)}var o=!1;return this.hc?this.uc(t)&&(this.oc.next(t),o=!0):this.cc(t,this.onlineState)&&(this.lc(t),o=!0),this.ac=t,o},Zh.prototype.onError=function(t){this.oc.error(t)},Zh.prototype.cu=function(t){this.onlineState=t;var e=!1;return this.ac&&!this.hc&&this.cc(this.ac,t)&&(this.lc(this.ac),e=!0),e},Zh.prototype.cc=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options._c&&n||t.docs._()&&"Offline"!==e)},Zh.prototype.uc=function(t){if(0<t.docChanges.length)return!0;var e=this.ac&&this.ac.hasPendingWrites!==t.hasPendingWrites;return!(!t.Mt&&!e)&&!0===this.options.includeMetadataChanges},Zh.prototype.lc=function(t){t=Wr.Ut(t.query,t.docs,t.xt,t.fromCache),this.hc=!0,this.oc.next(t)},Zh),Xh=(Jh.prototype.zi=function(t){this.fc=t},Jh.prototype.En=function(e,i,r,o){var s=this;return i.vs()||r.isEqual(Qi.min())?this.dc(e,i):this.fc.dn(e,o).next(function(t){var n=s.wc(i,t);return(i.ks()||i.Ls())&&s.ru(i.ds,n,o,r)?s.dc(e,i):(Ti()<=p.DEBUG&&Ai("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.fc.En(e,i,r).next(function(e){return n.forEach(function(t){e=e.et(t.key,t)}),e}))})},Jh.prototype.wc=function(n,t){var i=new Pr(function(t,e){return n.Cs(t,e)});return t.forEach(function(t,e){e instanceof Ms&&n.matches(e)&&(i=i.add(e))}),i},Jh.prototype.ru=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},Jh.prototype.dc=function(t,e){return Ti()<=p.DEBUG&&Ai("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.fc.En(t,e,Qi.min())},Jh),Qh=($h.prototype.mc=function(t){return wu.resolve(0===this.hn.length)},$h.prototype.er=function(t,e,n,i){var r=this.Tc;this.Tc++,0<this.hn.length&&this.hn[this.hn.length-1];var o=new gu(r,e,n,i);this.hn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.Ec=this.Ec.add(new $u(a.key,r)),this.an.Kn(t,a.key.path.g())}return wu.resolve(o)},$h.prototype.ur=function(t,e){return wu.resolve(this.Ic(e))},$h.prototype.Cr=function(t,e){var n=e+1,i=this.Rc(n),r=i<0?0:i;return wu.resolve(this.hn.length>r?this.hn[r]:null)},$h.prototype.lr=function(){return wu.resolve(0===this.hn.length?-1:this.Tc-1)},$h.prototype.Yi=function(t){return wu.resolve(this.hn.slice())},$h.prototype.cn=function(t,e){var n=this,i=new $u(e,0),r=new $u(e,Number.POSITIVE_INFINITY),o=[];return this.Ec.vt([i,r],function(t){var e=n.Ic(t.Zr);o.push(e)}),wu.resolve(o)},$h.prototype.Tn=function(t,e){var i=this,r=new Pr(Ui);return e.forEach(function(t){var e=new $u(t,0),n=new $u(t,Number.POSITIVE_INFINITY);i.Ec.vt([e,n],function(t){r=r.add(t.Zr)})}),wu.resolve(this.Ac(r))},$h.prototype.Pn=function(t,e){var n=e.path,i=n.length+1,r=n;ur.W(r)||(r=r.child(""));var o=new $u(new ur(r),0),s=new Pr(Ui);return this.Ec.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.Zr)),!0)},o),wu.resolve(this.Ac(s))},$h.prototype.Ac=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ic(t);null!==e&&i.push(e)}),i},$h.prototype.cr=function(n,i){var r=this;Oi(0===this.Pc(i.batchId,"removed")),this.hn.shift();var o=this.Ec;return wu.forEach(i.mutations,function(t){var e=new $u(t.key,i.batchId);return o=o.delete(e),r.Vr.Vc(n,t.key)}).next(function(){r.Ec=o})},$h.prototype.pc=function(t){},$h.prototype.Jr=function(t,e){var n=new $u(e,0),i=this.Ec.Ct(n);return wu.resolve(e.isEqual(i&&i.key))},$h.prototype.hr=function(t){return this.hn.length,wu.resolve()},$h.prototype.Pc=function(t,e){return this.Rc(t)},$h.prototype.Rc=function(t){return 0===this.hn.length?0:t-this.hn[0].batchId},$h.prototype.Ic=function(t){var e=this.Rc(t);return e<0||e>=this.hn.length?null:this.hn[e]},$h),Kh=(Yh.prototype.Ar=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.yc(e);return this.docs=this.docs.et(i,{gc:e,size:s,readTime:n}),this.size+=s-o,this.an.Kn(t,i.path.g())},Yh.prototype.Rr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Yh.prototype._n=function(t,e){var n=this.docs.get(e);return wu.resolve(n?n.gc:null)},Yh.prototype.getEntries=function(t,e){var n=this,i=kr();return e.forEach(function(t){var e=n.docs.get(t);i=i.et(t,e?e.gc:null)}),wu.resolve(i)},Yh.prototype.En=function(t,e,n){for(var i=Vr(),r=new ur(e.path.child("")),o=this.docs.ut(r);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.gc,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Ms&&e.matches(h)&&(i=i.et(h.key,h))}return wu.resolve(i)},Yh.prototype.bc=function(t,e){return wu.forEach(this.docs,function(t){return e(t)})},Yh.prototype.ir=function(t){return new Yh.vc(this)},Yh.prototype.Sc=function(t){return wu.resolve(this.size)},Yh);function Yh(t,e){this.an=t,this.yc=e,this.docs=new br(ur.P),this.size=0}function $h(t,e){this.an=t,this.Vr=e,this.hn=[],this.Tc=1,this.Ec=new Pr($u.Qr)}function Jh(){}function Zh(t,e,n){this.query=t,this.oc=e,this.hc=!1,this.ac=null,this.onlineState="Unknown",this.options=n||{}}function tc(t){this.Ia=t,this.tc=new zi(function(t){return t.canonicalId()},function(t,e){return t.isEqual(e)}),this.onlineState="Unknown",this.ec=new Set,this.Ia.subscribe(this)}function ec(t,e,n,i,r,o){this.jh=t,this.Au=e,this.bh=n,this.Pu=i,this.currentUser=r,this.Vu=o,this.pu=null,this.yu=new zi(function(t){return t.canonicalId()},function(t,e){return t.isEqual(e)}),this.gu=new Map,this.bu=[],this.vu=new br(ur.P),this.Su=new Map,this.Cu=new Yu,this.Du={},this.Fu=new Map,this.$u=ku.Yn(),this.onlineState="Unknown"}function nc(t,e,n,i){this.Xn=t,this.bh=e,this.updateFunction=n,this.ti=i,this.du=5,this._i=new Ru(this.Xn,"transaction_retry")}function ic(t,e){this.query=t,this.Xa=e,this.Ja=null,this.Ht=!1,this.Za=Mr(),this.xt=Mr(),this.tu=new zr(t.Cs.bind(t))}function rc(){this.xa=new Fh,this.Ma={},this.Ia=null,this.Lh=null,this.bn=null}function oc(){this.activeTargetIds=Fr()}function sc(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.jh=t,this.bh=e,this.Xn=n,this.Gh=[],this.Kh=new Map,this.zh=null,this.Hh=new Set,this.Yh=r,this.Yh.Xh(function(t){n.ii(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Jh()?(Ai("RemoteStore","Restarting streams for network reachability change."),[4,this.Zh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ta=new Mh(n,i),this.ea=(h=this.bh,c=n,l={lh:this.sa.bind(this),rh:this.na.bind(this),fh:this.ia.bind(this)},f=Ri(h),new Uh(c,f.Go,f.credentials,f.serializer,l)),this.ra=(o=this.bh,s=n,u={lh:this.oa.bind(this),rh:this.ha.bind(this),Rh:this.aa.bind(this),Ih:this.Ih.bind(this)},a=Ri(o),new Vh(s,a.Go,a.credentials,a.serializer,u))}function uc(t,e){this.Xn=t,this.Lh=e,this.state="Unknown",this.qh=0,this.Oh=null,this.xh=!0}function ac(t){this.bh=t,this.vh=new Map,this.mutations=[],this.Sh=!1,this.Ch=null,this.Dh=new Set}function hc(t,e,n){var i=this;return(i=Ah.call(this)||this).Go=t,i.credentials=e,i.serializer=n,i.Vh=!1,i}function cc(t,e,n,i,r){var o=this;return(o=Nh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.Th=!1,o.lastStreamToken=lr.H,o}function lc(t,e,n,i,r){var o=this;return(o=Ph.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function fc(t,e,n,i,r,o){this.Fn=t,this.jo=n,this.Go=i,this.Ko=r,this.listener=o,this.state=0,this.zo=0,this.Ho=null,this.stream=null,this._i=new Ru(t,e)}function pc(t,e){this.Uo=t,this.Qo=e}function dc(t,e){this.Uo=t,this.Qo=e,this.type="FirstParty",this.user=gh.Fo}function yc(t){var e=this;this.Oo=null,this.currentUser=gh.UNAUTHENTICATED,this.xo=!1,this.Mo=0,this.No=null,this.forceRefresh=!1,this.Oo=function(){e.Mo++,e.currentUser=e.Bo(),e.xo=!0,e.No&&e.No(e.currentUser)},this.Mo=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Oo):(this.Oo(null),t.get().then(function(t){e.auth=t,e.Oo&&e.auth.addAuthTokenListener(e.Oo)},function(){}))}function vc(){this.No=null}function gc(t){var e=this;return(e=Sh.call(this)||this).kc=t,e}function mc(){this.sr=new zi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Cc=!1}Kh.vc=(Object.defineProperty(mc.prototype,"readTime",{get:function(){return this.Dc},set:function(t){this.Dc=t},enumerable:!0,configurable:!0}),mc.prototype.Ar=function(t,e){this.Fc(),this.readTime=e,this.sr.set(t.key,t)},mc.prototype.Rr=function(t,e){this.Fc(),e&&(this.readTime=e),this.sr.set(t,null)},mc.prototype._n=function(t,e){this.Fc();var n=this.sr.get(e);return void 0!==n?wu.resolve(n):this.$c(t,e)},mc.prototype.getEntries=function(t,e){return this.Nc(t,e)},mc.prototype.apply=function(t){return this.Fc(),this.Cc=!0,this.ou(t)},mc.prototype.Fc=function(){},n(gc,Sh=mc),gc.prototype.ou=function(n){var i=this,r=[];return this.sr.forEach(function(t,e){e?r.push(i.kc.Ar(n,e,i.readTime)):i.kc.Rr(t)}),wu.nn(r)},gc.prototype.$c=function(t,e){return this.kc._n(t,e)},gc.prototype.Nc=function(t,e){return this.kc.getEntries(t,e)},gc);var wc,bc=(Hc.prototype.ge=function(t,n){return this.Lc.forEach(function(t,e){return n(e)}),wu.resolve()},Hc.prototype._r=function(t){return wu.resolve(this.lastRemoteSnapshotVersion)},Hc.prototype.Mc=function(t){return wu.resolve(this.qc)},Hc.prototype.Nr=function(t){return this.highestTargetId=this.xc.next(),wu.resolve(this.highestTargetId)},Hc.prototype.pr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.qc&&(this.qc=e),wu.resolve()},Hc.prototype.Bc=function(t){this.Lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.xc=new ku(e),this.highestTargetId=e),t.sequenceNumber>this.qc&&(this.qc=t.sequenceNumber)},Hc.prototype.kr=function(t,e){return this.Bc(e),this.targetCount+=1,wu.resolve()},Hc.prototype.Ir=function(t,e){return this.Bc(e),wu.resolve()},Hc.prototype.Uc=function(t,e){return this.Lc.delete(e.target),this.Oc.Hr(e.targetId),--this.targetCount,wu.resolve()},Hc.prototype.Qc=function(n,i,r){var o=this,s=0,u=[];return this.Lc.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Lc.delete(t),u.push(o.Wc(n,e.targetId)),s++)}),wu.nn(u).next(function(){return s})},Hc.prototype.jc=function(t){return wu.resolve(this.targetCount)},Hc.prototype.$r=function(t,e){var n=this.Lc.get(e)||null;return wu.resolve(n)},Hc.prototype.Tr=function(t,e,n){return this.Oc.Gr(e,n),wu.resolve()},Hc.prototype.wr=function(e,t,n){this.Oc.zr(t,n);var i=this.persistence.Vr,r=[];return i&&t.forEach(function(t){r.push(i.Vc(e,t))}),wu.nn(r)},Hc.prototype.Wc=function(t,e){return this.Oc.Hr(e),wu.resolve()},Hc.prototype.Or=function(t,e){var n=this.Oc.Xr(e);return wu.resolve(n)},Hc.prototype.Jr=function(t,e){return wu.resolve(this.Oc.Jr(e))},Hc),Ec=(zc.prototype.start=function(){return Promise.resolve()},zc.prototype.wa=function(){return this.zc=!1,Promise.resolve()},Object.defineProperty(zc.prototype,"Yc",{get:function(){return this.zc},enumerable:!0,configurable:!0}),zc.prototype.Xc=function(){},zc.prototype.Ki=function(){return this.an},zc.prototype.Bi=function(t){var e=this.Gc[t.Co()];return e||(e=new Qh(this.an,this.Vr),this.Gc[t.Co()]=e),e},zc.prototype.ji=function(){return this.Wi},zc.prototype.Qi=function(){return this.on},zc.prototype.runTransaction=function(t,e,n){var i=this;Ai("MemoryPersistence","Starting transaction:",t);var r=new _c(this.Kc.next());return this.Vr.Jc(),n(r).next(function(t){return i.Vr.Zc(r).next(function(){return t})}).en().then(function(t){return r.tl(),t})},zc.prototype.el=function(e,n){return wu.rn(Object.values(this.Gc).map(function(t){return function(){return t.Jr(e,n)}}))},zc),_c=(Bc.prototype.nl=function(t){this.sl.push(t)},Bc.prototype.tl=function(){this.sl.forEach(function(t){return t()})},n(Gc,wc=Bc),Gc),Ic=(jc.ol=function(t){return new jc(t)},Object.defineProperty(jc.prototype,"hl",{get:function(){if(this.rl)return this.rl;throw Si()},enumerable:!0,configurable:!0}),jc.prototype.br=function(t,e,n){return this.il.br(n,e),this.hl.delete(n),wu.resolve()},jc.prototype.vr=function(t,e,n){return this.il.vr(n,e),this.hl.add(n),wu.resolve()},jc.prototype.Vc=function(t,e){return this.hl.add(e),wu.resolve()},jc.prototype.removeTarget=function(t,e){var n=this;this.il.Hr(e.targetId).forEach(function(t){return n.hl.add(t)});var i=this.persistence.ji();return i.Or(t,e.targetId).next(function(t){t.forEach(function(t){return n.hl.add(t)})}).next(function(){return i.Uc(t,e)})},jc.prototype.Jc=function(){this.rl=new Set},jc.prototype.Zc=function(t){var n=this,i=this.persistence.Qi().ir();return wu.forEach(this.hl,function(e){return n.al(t,e).next(function(t){t||i.Rr(e)})}).next(function(){return n.rl=null,i.apply(t)})},jc.prototype.Pr=function(t,e){var n=this;return this.al(t,e).next(function(t){t?n.hl.delete(e):n.hl.add(e)})},jc.prototype.Hc=function(t){return 0},jc.prototype.al=function(t,e){var n=this;return wu.rn([function(){return wu.resolve(n.il.Jr(e))},function(){return n.persistence.ji().Jr(t,e)},function(){return n.persistence.el(t,e)}])},jc),Tc=(Fc.prototype.lh=function(t){this.ll=t},Fc.prototype.rh=function(t){this._l=t},Fc.prototype.onMessage=function(t){this.fl=t},Fc.prototype.close=function(){this.cl()},Fc.prototype.send=function(t){this.ul(t)},Fc.prototype.dl=function(){this.ll()},Fc.prototype.wl=function(t){this._l(t)},Fc.prototype.Tl=function(t){this.fl(t)},Fc),Ac={BatchGetDocuments:"batchGet",Commit:"commit"},Nc="gl-js/ fire/"+_i,Pc=(qc.prototype.ml=function(t,e){if(e)for(var n in e.$o)e.$o.hasOwnProperty(n)&&(t[n]=e.$o[n]);t["X-Goog-Api-Client"]=Nc},qc.prototype.yh=function(a,i,r){var h=this,c=this.Il(a);return new Promise(function(o,s){var u=new wi;u.listenOnce(gi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case vi.NO_ERROR:var t=u.getResponseJson();Ai("Connection","XHR received:",JSON.stringify(t)),o(t);break;case vi.TIMEOUT:Ai("Connection",'RPC "'+a+'" timed out'),s(new Wi(Hi.DEADLINE_EXCEEDED,"Request time out"));break;case vi.HTTP_ERROR:var e=u.getStatus();if(Ai("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Hi).indexOf(r)?r:Hi.UNKNOWN);s(new Wi(i,n.message))}else s(new Wi(Hi.UNKNOWN,"Server responded with status "+u.getStatus()))}else Ai("Connection",'RPC "'+a+'" failed'),s(new Wi(Hi.UNAVAILABLE,"Connection failed."));break;default:Si()}}finally{Ai("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);Ai("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.ml(n,r),u.send(c,"POST",e,n,15)})},qc.prototype.gh=function(t,e,n){return this.yh(t,e,n)},qc.prototype._h=function(t,e){var n,i,r=[this.El,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=yi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ml(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(i=g()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Ai("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Tc({ul:function(t){l?Ai("Connection","Not sending because WebChannel is closed:",t):(c||(Ai("Connection","Opening WebChannel transport."),h.open(),c=!0),Ai("Connection","WebChannel sending:",t),h.send(t))},cl:function(){return h.close()}});return a(mi.EventType.OPEN,function(){l||Ai("Connection","WebChannel transport opened.")}),a(mi.EventType.CLOSE,function(){l||(l=!0,Ai("Connection","WebChannel transport closed"),f.wl())}),a(mi.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ii.logLevel<=p.WARN){var i=e.map(Pi);Ii.warn.apply(Ii,v(["Firestore ("+_i+"): Connection"],i))}}("Connection","WebChannel transport errored:",t),f.wl(new Wi(Hi.UNAVAILABLE,"The operation could not be completed")))}),a(mi.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];Oi(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){Ai("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=dr[r];if(void 0!==t)return wr(t)}(),s=i.message;void 0===o&&(o=Hi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.wl(new Wi(o,s)),h.close()}else Ai("Connection","WebChannel received:",n),f.Tl(n)}}),setTimeout(function(){f.dl()},0),f},qc.prototype.Il=function(t){var e=Ac[t];return this.El+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},qc),Sc=(Mc.prototype.Xh=function(t){this.pl.push(t)},Mc.prototype.wa=function(){window.removeEventListener("online",this.Rl),window.removeEventListener("offline",this.Pl)},Mc.prototype.yl=function(){window.addEventListener("online",this.Rl),window.addEventListener("offline",this.Pl)},Mc.prototype.Al=function(){Ai("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.pl;t<e.length;t++)(0,e[t])(0)},Mc.prototype.Vl=function(){Ai("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.pl;t<e.length;t++)(0,e[t])(1)},Mc.gl=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Mc),Oc=(xc.prototype.Xh=function(t){},xc.prototype.wa=function(){},xc),Rc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Lc=(Cc.prototype.initialize=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.Pu=this.bl(n),this.persistence=this.vl(n),[4,this.persistence.start()];case 1:return t.sent(),this.Sl=this.Cl(n),this.jh=this.Dl(n),this.Au=this.Fl(n),this.Ia=this.$l(n),this.Nl=this.kl(n),this.Pu.Lh=function(t){return e.Ia.cu(t,1)},this.Au.Ia=this.Ia,[4,this.jh.start()];case 2:return t.sent(),[4,this.Pu.start()];case 3:return t.sent(),[4,this.Au.start()];case 4:return t.sent(),[4,this.Au.ka(this.Ia.Nu)];case 5:return t.sent(),[2]}})})},Cc.prototype.kl=function(t){return new Hh(this.Ia)},Cc.prototype.Cl=function(t){return null},Cc.prototype.Dl=function(t){return new Xu(this.persistence,new Xh,t.Ll)},Cc.prototype.vl=function(t){if(t.Ol.ql)throw new Wi(Hi.FAILED_PRECONDITION,Rc);return new Ec(Ic.ol)},Cc.prototype.Fl=function(t){var e=this;return new qh(this.jh,t.bh,t.Xn,function(t){return e.Ia.cu(t,0)},new(Sc.gl()?Sc:Oc))},Cc.prototype.bl=function(t){return new jh},Cc.prototype.$l=function(t){return new zh(this.jh,this.Au,t.bh,this.Pu,t.Ll,t.Vu)},Cc.prototype.clearPersistence=function(t){throw new Wi(Hi.FAILED_PRECONDITION,Rc)},Cc),Dc=(Vc.prototype.start=function(e,n){var i=this;this.ph();var r=new Ou,o=new Ou,s=!1;return this.credentials.Lo(function(t){if(!s)return s=!0,Ai("FirestoreClient","Initializing. user=",t.uid),i.Ml(e,n,t,o).then(r.resolve,r.reject);i.Xn.Ri(function(){return i.Au.Na(t)})}),this.Xn.ii(function(){return r.promise}),o.promise},Vc.prototype.enableNetwork=function(){var t=this;return this.ph(),this.Xn.enqueue(function(){return t.Ia.enableNetwork()})},Vc.prototype.Ml=function(h,c,l,f){return d(this,void 0,void 0,function(){var i,r,o,s,u,a=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(u=this.xl,Promise.resolve(new Pc(u)))];case 1:return i=t.sent(),r=Ja(this.xl.s),e=i,n=this.credentials,o=new Ch(e,n,r),[4,h.initialize({Xn:this.Xn,xl:this.xl,bh:o,clientId:this.clientId,Ll:l,Vu:100,Ol:c})];case 2:return t.sent(),this.persistence=h.persistence,this.Pu=h.Pu,this.jh=h.jh,this.Au=h.Au,this.Ia=h.Ia,this.Sl=h.Sl,this.Bl=h.Nl,this.persistence.Xc(function(){return d(a,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(s=t.sent(),f.reject(s),!this.Ul(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.Ml(new Lc,{ql:!1},l,f))];case 4:return[2]}var e,n})})},Vc.prototype.Ul=function(t){return"FirebaseError"===t.name?t.code===Hi.FAILED_PRECONDITION||t.code===Hi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Vc.prototype.ph=function(){if(this.Xn.di)throw new Wi(Hi.FAILED_PRECONDITION,"The client has already been terminated.")},Vc.prototype.disableNetwork=function(){var t=this;return this.ph(),this.Xn.enqueue(function(){return t.Ia.disableNetwork()})},Vc.prototype.terminate=function(){var t=this;return this.Xn.Ii(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Sl&&this.Sl.stop(),[4,this.Au.wa()];case 1:return t.sent(),[4,this.Pu.wa()];case 2:return t.sent(),[4,this.persistence.wa()];case 3:return t.sent(),this.credentials.qo(),[2]}})})})},Vc.prototype.waitForPendingWrites=function(){var t=this;this.ph();var e=new Ou;return this.Xn.ii(function(){return t.Ia.ju(e)}),e.promise},Vc.prototype.listen=function(t,e,n){var i=this;this.ph();var r=new Wh(t,e,n);return this.Xn.ii(function(){return i.Bl.listen(r)}),r},Vc.prototype.Ea=function(t){var e=this;this.Ql||this.Xn.ii(function(){return e.Bl.Ea(t)})},Vc.prototype.Wl=function(o){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){switch(t.label){case 0:return this.ph(),r=new Ou,[4,this.Xn.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.jh.Dr(o)];case 1:return(e=t.sent())instanceof Ms?r.resolve(e):e instanceof qs?r.resolve(null):r.reject(new Wi(Hi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=zu(n,"Failed to get document '"+o+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})},Vc.prototype.jl=function(a){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return this.ph(),u=new Ou,[4,this.Xn.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.jh.qr(a,!0)];case 1:return e=t.sent(),n=new Gh(a,e.xr),i=n.su(e.documents),r=n.ou(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=zu(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Vc.prototype.write=function(t){var e=this;this.ph();var n=new Ou;return this.Xn.ii(function(){return e.Ia.write(t,n)}),n.promise},Vc.prototype.s=function(){return this.xl.s},Vc.prototype.ic=function(t){var e=this;this.ph(),this.Xn.ii(function(){return e.Bl.ic(t),Promise.resolve()})},Vc.prototype.rc=function(t){var e=this;this.Ql||this.Xn.ii(function(){return e.Bl.rc(t),Promise.resolve()})},Object.defineProperty(Vc.prototype,"Ql",{get:function(){return this.Xn.di},enumerable:!0,configurable:!0}),Vc.prototype.transaction=function(t){var e=this;this.ph();var n=new Ou;return this.Xn.ii(function(){return e.Ia.runTransaction(e.Xn,t,n),Promise.resolve()}),n.promise},Vc),kc=(Uc.prototype.next=function(t){this.Gl(this.observer.next,t)},Uc.prototype.error=function(t){this.Gl(this.observer.error,t)},Uc.prototype.Kl=function(){this.muted=!0},Uc.prototype.Gl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Uc);function Uc(t){this.observer=t,this.muted=!1}function Vc(t,e,n){this.xl=t,this.credentials=e,this.Xn=n,this.clientId=Di.t()}function Cc(){}function xc(){}function Mc(){var t=this;this.Rl=function(){return t.Al()},this.Pl=function(){return t.Vl()},this.pl=[],this.yl()}function qc(t){this.s=t.s;var e=t.ssl?"https":"http";this.El=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function Fc(t){this.ul=t.ul,this.cl=t.cl}function jc(t){this.persistence=t,this.il=new Yu,this.rl=null}function Gc(t){var e=this;return(e=wc.call(this)||this).Er=t,e}function Bc(){this.sl=[]}function zc(t){var e=this;this.Gc={},this.Kc=new _u(0),this.zc=!1,this.zc=!0,this.Vr=t(this),this.Wi=new bc(this),this.an=new Lu,this.on=new Kh(this.an,function(t){return e.Vr.Hc(t)})}function Hc(t){this.persistence=t,this.Lc=new zi(function(t){return du(t)},yu),this.lastRemoteSnapshotVersion=Qi.min(),this.highestTargetId=0,this.qc=0,this.Oc=new Yu,this.targetCount=0,this.xc=ku.Hn()}function Wc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Xc,Qc,Kc,Yc,$c=(_l.prototype.Yl=function(t){switch(ho(t)){case 0:return null;case 1:return t.booleanValue;case 2:return go(t.integerValue||t.doubleValue);case 3:return this.Xl(t.timestampValue);case 4:return this.Jl(t);case 5:return t.stringValue;case 6:return new Ia(mo(t.bytesValue));case 7:return this.Zl(t.referenceValue);case 8:return this.t_(t.geoPointValue);case 9:return this.e_(t.arrayValue);case 10:return this.s_(t.mapValue);default:throw Si()}},_l.prototype.s_=function(t){var n=this,i={};return Fi(t.fields||{},function(t,e){i[t]=n.Yl(e)}),i},_l.prototype.t_=function(t){return new Ba(go(t.latitude),go(t.longitude))},_l.prototype.e_=function(t){var e=this;return(t.values||[]).map(function(t){return e.Yl(t)})},_l.prototype.Jl=function(t){switch(this.zl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return so(n)?t(n):n}(t);return null==e?null:this.Yl(e);case"estimate":return this.Xl(uo(t));default:return null}},_l.prototype.Xl=function(t){var e=vo(t),n=new Xi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},_l.prototype.Zl=function(t){var e=Yi.N(t);Oi(Bo(e));var n=new xi(e.get(1),e.get(3)),i=new ur(e.p(5));return n.isEqual(this.s)||Ni("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Hl(i)},_l),Jc=Hu.$i,Zc=(El.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},El),tl=(Object.defineProperty(bl.prototype,"__",{get:function(){return this.f_||(this.f_=new uh(this.fo,this.l_.ignoreUndefinedProperties)),this.f_},enumerable:!0,configurable:!0}),bl.prototype.settings=function(t){ea("Firestore.settings",arguments,1),ra("Firestore.settings","object",1,t);var e=new Zc(t);if(this.o_&&!this.l_.isEqual(e))throw new Wi(Hi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.l_=e).credentials&&(this.u_=function(t){if(!t)return new Oh;switch(t.type){case"gapi":var e=t.d_;return Oi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dh(e,t.Qo||"0");case"provider":return t.d_;default:throw new Wi(Hi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},bl.prototype.enableNetwork=function(){return this.r_(),this.o_.enableNetwork()},bl.prototype.disableNetwork=function(){return this.r_(),this.o_.disableNetwork()},bl.prototype.enablePersistence=function(t){var e,n;if(this.o_)throw new Wi(Hi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Ni("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Wi(Hi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.w_(this.c_,{ql:!0,cacheSizeBytes:this.l_.cacheSizeBytes,synchronizeTabs:i,T_:r})},bl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.o_&&!this.o_.Ql)throw new Wi(Hi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Ou,[2,(this.i_.wi(function(){return d(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.E_(),[4,this.c_.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},bl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(bl.prototype,"m_",{get:function(){return this.r_(),this.o_.Ql},enumerable:!0,configurable:!0}),bl.prototype.waitForPendingWrites=function(){return this.r_(),this.o_.waitForPendingWrites()},bl.prototype.onSnapshotsInSync=function(t){if(this.r_(),Wc(t))return this.I_(t);ra("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.I_(e)},bl.prototype.I_=function(t){var e=this,n=new kc({next:function(){t.next&&t.next()},error:function(t){throw Si()}});return this.o_.ic(n),function(){n.Kl(),e.o_.rc(n)}},bl.prototype.r_=function(){return this.o_||this.w_(new Lc,{ql:!1}),this.o_},bl.prototype.E_=function(){return new Ci(this.fo,this.a_,this.l_.host,this.l_.ssl,this.l_.forceLongPolling)},bl.prototype.w_=function(t,e){var n=this.E_();return this.o_=new Dc(n,this.u_,this.i_),this.o_.start(t,e)},bl.h_=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Wi(Hi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Wi(Hi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new xi(n)},Object.defineProperty(bl.prototype,"app",{get:function(){if(!this.n_)throw new Wi(Hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.n_},enumerable:!0,configurable:!0}),bl.prototype.collection=function(t){return ea("Firestore.collection",arguments,1),ra("Firestore.collection","non-empty string",1,t),this.r_(),new hl(Yi.N(t),this,null)},bl.prototype.doc=function(t){return ea("Firestore.doc",arguments,1),ra("Firestore.doc","non-empty string",1,t),this.r_(),il.R_(Yi.N(t),this,null)},bl.prototype.collectionGroup=function(t){if(ea("Firestore.collectionGroup",arguments,1),ra("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.r_(),new ul(new js(Yi.k,t),this,null)},bl.prototype.runTransaction=function(e){var n=this;return ea("Firestore.runTransaction",arguments,1),ra("Firestore.runTransaction","function",1,e),this.r_().transaction(function(t){return e(new el(n,t))})},bl.prototype.batch=function(){return this.r_(),new nl(this)},Object.defineProperty(bl,"logLevel",{get:function(){switch(Ti()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),bl.setLogLevel=function(t){ea("Firestore.setLogLevel",arguments,1),ha("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ii.setLogLevel(t)},bl.prototype.A_=function(){return this.l_.timestampsInSnapshots},bl),el=(wl.prototype.get=function(t){var n=this;ea("Transaction.get",arguments,1);var i=Nl("Transaction.get",t,this.P_);return this.V_.Fh([i.do]).then(function(t){if(!t||1!==t.length)return Si();var e=t[0];if(e instanceof qs)return new ol(n.P_,i.do,null,!1,!1,i.wo);if(e instanceof Ms)return new ol(n.P_,i.do,e,!1,!1,i.wo);throw Si()})},wl.prototype.set=function(t,e,n){ia("Transaction.set",arguments,2,3);var i=Nl("Transaction.set",t,this.P_);n=Il("Transaction.set",n);var r=Pl(i.wo,e,"Transaction.set"),o=r[0],s=r[1],u=this.P_.__.Vo(s,o,n);return this.V_.set(i.do,u),this},wl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Ta?(na("Transaction.update",arguments,3),i=Nl("Transaction.update",t,this.P_),this.P_.__.bo("Transaction.update",e,n,o)):(ea("Transaction.update",arguments,2),i=Nl("Transaction.update",t,this.P_),this.P_.__.yo("Transaction.update",e)),this.V_.update(i.do,r),this},wl.prototype.delete=function(t){ea("Transaction.delete",arguments,1);var e=Nl("Transaction.delete",t,this.P_);return this.V_.delete(e.do),this},wl),nl=(ml.prototype.set=function(t,e,n){ia("WriteBatch.set",arguments,2,3),this.g_();var i=Nl("WriteBatch.set",t,this.P_);n=Il("WriteBatch.set",n);var r=Pl(i.wo,e,"WriteBatch.set"),o=r[0],s=r[1],u=this.P_.__.Vo(s,o,n);return this.p_=this.p_.concat(u.To(i.do,us.Ke())),this},ml.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.g_(),r="string"==typeof e||e instanceof Ta?(na("WriteBatch.update",arguments,3),i=Nl("WriteBatch.update",t,this.P_),this.P_.__.bo("WriteBatch.update",e,n,o)):(ea("WriteBatch.update",arguments,2),i=Nl("WriteBatch.update",t,this.P_),this.P_.__.yo("WriteBatch.update",e)),this.p_=this.p_.concat(r.To(i.do,us.exists(!0))),this},ml.prototype.delete=function(t){ea("WriteBatch.delete",arguments,1),this.g_();var e=Nl("WriteBatch.delete",t,this.P_);return this.p_=this.p_.concat(new fs(e.do,us.Ke())),this},ml.prototype.commit=function(){return this.g_(),this.y_=!0,0<this.p_.length?this.P_.r_().write(this.p_):Promise.resolve()},ml.prototype.g_=function(){if(this.y_)throw new Wi(Hi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ml),il=(n(gl,Yc=th),gl.R_=function(t,e,n){if(t.length%2!=0)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new gl(new ur(t),e,n)},Object.defineProperty(gl.prototype,"id",{get:function(){return this.do.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(gl.prototype,"parent",{get:function(){return new hl(this.do.path.g(),this.firestore,this.wo)},enumerable:!0,configurable:!0}),Object.defineProperty(gl.prototype,"path",{get:function(){return this.do.path.$()},enumerable:!0,configurable:!0}),gl.prototype.collection=function(t){if(ea("DocumentReference.collection",arguments,1),ra("DocumentReference.collection","non-empty string",1,t),!t)throw new Wi(Hi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Yi.N(t);return new hl(this.do.path.child(e),this.firestore,null)},gl.prototype.isEqual=function(t){if(!(t instanceof gl))throw ya("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.do.isEqual(t.do)&&this.wo===t.wo},gl.prototype.set=function(t,e){ia("DocumentReference.set",arguments,1,2),e=Il("DocumentReference.set",e);var n=Pl(this.wo,t,"DocumentReference.set"),i=n[0],r=n[1],o=this.firestore.__.Vo(r,i,e);return this.o_.write(o.To(this.do,us.Ke()))},gl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Ta?(na("DocumentReference.update",arguments,2),this.firestore.__.bo("DocumentReference.update",t,e,i)):(ea("DocumentReference.update",arguments,1),this.firestore.__.yo("DocumentReference.update",t)),this.o_.write(n.To(this.do,us.exists(!0)))},gl.prototype.delete=function(){return ea("DocumentReference.delete",arguments,0),this.o_.write([new fs(this.do,us.Ke())])},gl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ia("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Wc(t[r])||(da("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),ua("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Wc(t[r])?t[r]:(ra("DocumentReference.onSnapshot","function",r,t[r]),oa("DocumentReference.onSnapshot","function",r+1,t[r+1]),oa("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.b_(o,n)},gl.prototype.b_=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new kc({next:function(t){if(n.next){var e=t.docs.get(i.do);n.next(new ol(i.firestore,i.do,e,t.fromCache,t.hasPendingWrites,i.wo))}},error:e}),o=this.o_.listen(js.ms(this.do.path),r,t);return function(){r.Kl(),i.o_.Ea(o)}},gl.prototype.get=function(n){var i=this;return ia("DocumentReference.get",arguments,0,1),Al("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.r_().Wl(i.do).then(function(t){e(new ol(i.firestore,i.do,t,!0,t instanceof Ms&&t.Xe,i.wo))},t):i.v_(e,t,n)})},gl.prototype.v_=function(e,n,i){var r=this.b_({includeMetadataChanges:!0,_c:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Wi(Hi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Wi(Hi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},gl.prototype.withConverter=function(t){return new gl(this.do,this.firestore,t)},gl),rl=(vl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},vl),ol=(yl.prototype.data=function(t){var e=this;if(ia("DocumentSnapshot.data",arguments,0,1),t=Tl("DocumentSnapshot.data",t),this.S_){if(this.wo){var n=new sl(this.P_,this.do,this.S_,this.C_,this.D_,null);return this.wo.fromFirestore(n,t)}return new $c(this.P_.fo,this.P_.A_(),t.serverTimestamps||"none",function(t){return new il(t,e.P_,null)}).Yl(this.S_._s())}},yl.prototype.get=function(t,e){var n=this;if(ia("DocumentSnapshot.get",arguments,1,2),e=Tl("DocumentSnapshot.get",e),this.S_){var i=this.S_.data().field(dh("DocumentSnapshot.get",t));if(null!==i)return new $c(this.P_.fo,this.P_.A_(),e.serverTimestamps||"none",function(t){return new il(t,n.P_,n.wo)}).Yl(i)}},Object.defineProperty(yl.prototype,"id",{get:function(){return this.do.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(yl.prototype,"ref",{get:function(){return new il(this.do,this.P_,this.wo)},enumerable:!0,configurable:!0}),Object.defineProperty(yl.prototype,"exists",{get:function(){return null!==this.S_},enumerable:!0,configurable:!0}),Object.defineProperty(yl.prototype,"metadata",{get:function(){return new rl(this.D_,this.C_)},enumerable:!0,configurable:!0}),yl.prototype.isEqual=function(t){if(!(t instanceof yl))throw ya("isEqual","DocumentSnapshot",1,t);return this.P_===t.P_&&this.C_===t.C_&&this.do.isEqual(t.do)&&(null===this.S_?null===t.S_:this.S_.isEqual(t.S_))&&this.wo===t.wo},yl),sl=(n(dl,Kc=ol),dl.prototype.data=function(t){return Kc.prototype.data.call(this,t)},dl),ul=(pl.prototype.N_=function(t,e,n){var i;if(t.q()){if("array-contains"===e||"array-contains-any"===e)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.k_(n,e);for(var r=[],o=0,s=n;o<s.length;o++){var u=s[o];r.push(this.L_(u))}i={arrayValue:{values:r}}}else i=this.L_(n)}else"in"!==e&&"array-contains-any"!==e||this.k_(n,e),i=this.__.vo("Query.where",n,"in"===e);var a=Gs.create(t,e,i);return this.q_(a),a},pl.prototype.O_=function(t,e){if(null!==this.F_.startAt)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.F_.endAt)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new hu(t,e);return this.x_(n),n},pl.prototype.M_=function(t,e,n){if(!e)throw new Wi(Hi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var i=[],r=0,o=this.F_.orderBy;r<o.length;r++){var s=o[r];if(s.field.q())i.push(wo(this.fo,e.key));else{var u=e.field(s.field);if(so(u))throw new Wi(Hi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.$();throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}i.push(u)}}return new Qs(i,n)},pl.prototype.B_=function(t,e,n){var i=this.F_.fs;if(e.length>i.length)throw new Wi(Hi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.q()){if("string"!=typeof s)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.F_.Ms()&&-1!==s.indexOf("/"))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.F_.path.child(Yi.N(s));if(!ur.W(u))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ur(u);r.push(wo(this.fo,a))}else{var h=this.__.vo(t,s);r.push(h)}}return new Qs(r,n)},pl.prototype.U_=function(t){if(t.Ls()&&0===t.fs.length)throw new Wi(Hi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},pl.prototype.L_=function(t){if("string"==typeof t){if(""===t)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.F_.Ms()&&-1!==t.indexOf("/"))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.F_.path.child(Yi.N(t));if(!ur.W(e))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return wo(this.fo,new ur(e))}if(t instanceof th)return wo(this.fo,t.do);throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+fa(t)+".")},pl.prototype.k_=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},pl.prototype.q_=function(t){if(t instanceof Gs){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.qs()){var o=this.F_.Is();if(null!==o&&!o.isEqual(t.field))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.F_.Rs();null!==s&&this.Q_(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.F_.Os(n)),null===u&&i&&(u=this.F_.Os(e)),null!=u)throw u===t.op?new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},pl.prototype.x_=function(t){if(null===this.F_.Rs()){var e=this.F_.Is();null!==e&&this.Q_(e,t.field)}},pl.prototype.Q_=function(t,e){if(!e.isEqual(t))throw new Wi(Hi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(fl,Qc=pl),fl.prototype.where=function(t,e,n){ea("Query.where",arguments,3),pa("Query.where",3,n);var i=ha("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),r=dh("Query.where",t),o=this.N_(r,i,n);return new fl(this.F_.As(o),this.firestore,this.wo)},fl.prototype.orderBy=function(t,e){var n;if(ia("Query.orderBy",arguments,1,2),oa("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Wi(Hi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i=dh("Query.orderBy",t),r=this.O_(i,n);return new fl(this.F_.Ps(r),this.firestore,this.wo)},fl.prototype.limit=function(t){return ea("Query.limit",arguments,1),ra("Query.limit","number",1,t),va("Query.limit",1,t),new fl(this.F_.Vs(t),this.firestore,this.wo)},fl.prototype.limitToLast=function(t){return ea("Query.limitToLast",arguments,1),ra("Query.limitToLast","number",1,t),va("Query.limitToLast",1,t),new fl(this.F_.ps(t),this.firestore,this.wo)},fl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];na("Query.startAt",arguments,1);var i=this.W_("Query.startAt",t,e,!0);return new fl(this.F_.ys(i),this.firestore,this.wo)},fl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];na("Query.startAfter",arguments,1);var i=this.W_("Query.startAfter",t,e,!1);return new fl(this.F_.ys(i),this.firestore,this.wo)},fl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];na("Query.endBefore",arguments,1);var i=this.W_("Query.endBefore",t,e,!0);return new fl(this.F_.gs(i),this.firestore,this.wo)},fl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];na("Query.endAt",arguments,1);var i=this.W_("Query.endAt",t,e,!1);return new fl(this.F_.gs(i),this.firestore,this.wo)},fl.prototype.isEqual=function(t){if(!(t instanceof fl))throw ya("isEqual","Query",1,t);return this.firestore===t.firestore&&this.F_.isEqual(t.F_)&&this.wo===t.wo},fl.prototype.withConverter=function(t){return new fl(this.F_,this.firestore,t)},fl.prototype.W_=function(t,e,n,i){if(pa(t,1,e),e instanceof ol)return ea(t,v([e],n),1),this.M_(t,e.S_,i);var r=[e].concat(n);return this.B_(t,r,i)},fl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ia("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Wc(t[r])||(da("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),ua("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Wc(t[r])?t[r]:(ra("Query.onSnapshot","function",r,t[r]),oa("Query.onSnapshot","function",r+1,t[r+1]),oa("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.U_(this.F_),this.b_(i,n)},fl.prototype.b_=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new kc({next:function(t){e.next&&e.next(new al(n.firestore,n.F_,t,n.wo))},error:i}),o=this.firestore.r_(),s=o.listen(this.F_,r,t);return function(){r.Kl(),o.Ea(s)}},fl.prototype.get=function(n){var i=this;return ia("Query.get",arguments,0,1),Al("Query.get",n),this.U_(this.F_),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.r_().jl(i.F_).then(function(t){e(new al(i.firestore,i.F_,t,i.wo))},t):i.v_(e,t,n)})},fl.prototype.v_=function(e,n,i){var r=this.b_({includeMetadataChanges:!0,_c:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Wi(Hi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},fl),al=(Object.defineProperty(ll.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(ll.prototype,"empty",{get:function(){return this.G_.docs._()},enumerable:!0,configurable:!0}),Object.defineProperty(ll.prototype,"size",{get:function(){return this.G_.docs.size},enumerable:!0,configurable:!0}),ll.prototype.forEach=function(e,n){var i=this;ia("QuerySnapshot.forEach",arguments,1,2),ra("QuerySnapshot.forEach","function",1,e),this.G_.docs.forEach(function(t){e.call(n,i.H_(t))})},Object.defineProperty(ll.prototype,"query",{get:function(){return new ul(this.j_,this.P_,this.wo)},enumerable:!0,configurable:!0}),ll.prototype.docChanges=function(t){t&&(da("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ua("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.G_.Bt)throw new Wi(Hi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.K_&&this.z_===e||(this.K_=function(r,e,o,s){if(o.Ot._()){var n=0;return o.docChanges.map(function(t){var e=new sl(r,t.doc.key,t.doc,o.fromCache,o.xt.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.Ot;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new sl(r,t.doc.key,t.doc,o.fromCache,o.xt.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Si()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.P_,e,this.G_,this.wo),this.z_=e),this.K_},ll.prototype.isEqual=function(t){if(!(t instanceof ll))throw ya("isEqual","QuerySnapshot",1,t);return this.P_===t.P_&&this.j_.isEqual(t.j_)&&this.G_.isEqual(t.G_)&&this.wo===t.wo},ll.prototype.H_=function(t){return new sl(this.P_,t.key,t,this.metadata.fromCache,this.G_.xt.has(t.key),this.wo)},ll),hl=(n(cl,Xc=ul),Object.defineProperty(cl.prototype,"id",{get:function(){return this.F_.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(cl.prototype,"parent",{get:function(){var t=this.F_.path.g();return t._()?null:new il(new ur(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(cl.prototype,"path",{get:function(){return this.F_.path.$()},enumerable:!0,configurable:!0}),cl.prototype.doc=function(t){ia("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Di.t()),ra("CollectionReference.doc","non-empty string",1,t);var e=Yi.N(t);return il.R_(this.F_.path.child(e),this.firestore,this.wo)},cl.prototype.add=function(t){ea("CollectionReference.add",arguments,1),ra("CollectionReference.add","object",1,this.wo?this.wo.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},cl.prototype.withConverter=function(t){return new cl(this.Y_,this.firestore,t)},cl);function cl(t,e,n){var i=this;if(((i=Xc.call(this,js.ms(t),e,n)||this).Y_=t).length%2!=1)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return i}function ll(t,e,n,i){this.P_=t,this.j_=e,this.G_=n,this.wo=i,this.K_=null,this.z_=null,this.metadata=new rl(n.hasPendingWrites,n.fromCache)}function fl(t,e,n){var i=this;return(i=Qc.call(this,e.fo,e.__,t)||this).F_=t,i.firestore=e,i.wo=n,i}function pl(t,e,n){this.fo=t,this.__=e,this.F_=n}function dl(){return null!==Kc&&Kc.apply(this,arguments)||this}function yl(t,e,n,i,r,o){this.P_=t,this.do=e,this.S_=n,this.C_=i,this.D_=r,this.wo=o}function vl(t,e){this.hasPendingWrites=t,this.fromCache=e}function gl(t,e,n){var i=this;return(i=Yc.call(this,e.fo,t,n)||this).do=t,i.firestore=e,i.wo=n,i.o_=i.firestore.r_(),i}function ml(t){this.P_=t,this.p_=[],this.y_=!1}function wl(t,e){this.P_=t,this.V_=e}function bl(t,e,n){var i=this;if(void 0===n&&(n=new Lc),this.n_=null,this.i_=new ju,this.INTERNAL={delete:function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.r_(),[4,this.o_.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.n_=r,this.fo=bl.h_(r),this.a_=r.name,this.u_=new Rh(e)}else{var o=t;if(!o.projectId)throw new Wi(Hi.INVALID_ARGUMENT,"Must provide projectId");this.fo=new xi(o.projectId,o.database),this.a_="[DEFAULT]",this.u_=new Oh}this.c_=n,this.l_=new Zc({})}function El(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Wi(Hi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else sa("settings","non-empty string","host",t.host),this.host=t.host,ua("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(da("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ua("settings","object","credentials",t.credentials),this.credentials=t.credentials,ua("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ua("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Ni("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Ni("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,ua("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Hu.ki;else{if(t.cacheSizeBytes!==Jc&&t.cacheSizeBytes<Hu.Ni)throw new Wi(Hi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Hu.Ni);this.cacheSizeBytes=t.cacheSizeBytes}ua("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function _l(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.zl=n,this.Hl=i}function Il(t,e){if(void 0===e)return{merge:!1};if(da(t,e,["merge","mergeFields"]),ua(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+fa(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Wi(Hi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+fa(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof Ta}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Wi(Hi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function Tl(t,e){return void 0===e?{}:(da(t,e,["serverTimestamps"]),aa(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Al(t,e){oa(t,"object",1,e),e&&(da(t,e,["source"]),aa(t,0,"source",e.source,["default","server","cache"]))}function Nl(t,e,n){if(e instanceof th){if(e.firestore!==n)throw new Wi(Hi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ya(t,"DocumentReference",1,e)}function Pl(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var Sl=["length","name"];function Ol(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Wi(Hi.INVALID_ARGUMENT,t)}for(var i=0,r=Object.getOwnPropertyNames(t);i<r.length;i++){var o=r[i];-1===Sl.indexOf(o)&&(n[o]=t[o])}return n}var Rl,Ll=Ol(tl,"Use firebase.firestore() instead."),Dl=Ol(el,"Use firebase.firestore().runTransaction() instead."),kl=Ol(nl,"Use firebase.firestore().batch() instead."),Ul=Ol(il,"Use firebase.firestore().doc() instead."),Vl=Ol(ol),Cl=Ol(sl),xl=Ol(ul),Ml=Ol(al),ql=Ol(hl,"Use firebase.firestore().collection() instead."),Fl=Ol(ja,"Use FieldValue.<field>() instead."),jl=Ol(Ia,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Gl={Firestore:Ll,GeoPoint:Ba,Timestamp:Xi,Blob:jl,Transaction:Dl,WriteBatch:kl,DocumentReference:Ul,DocumentSnapshot:Vl,Query:xl,QueryDocumentSnapshot:Cl,QuerySnapshot:Ml,CollectionReference:ql,FieldPath:Ta,FieldValue:Fl,setLogLevel:tl.setLogLevel,CACHE_SIZE_UNLIMITED:Jc};(Rl=Bl).INTERNAL.registerComponent(new bi("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new tl(e,n,new Lc);var e,n},"PUBLIC").setServiceProps(Object.assign({},Gl))),Rl.registerVersion("@firebase/firestore","1.15.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
